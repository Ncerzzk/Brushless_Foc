ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"foc.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.SVPWM_Step,"ax",%progbits
  18              		.align	1
  19              		.arch armv7e-m
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	SVPWM_Step:
  26              	.LFB172:
  27              		.file 1 "Src/foc.c"
   1:Src/foc.c     **** #include "foc.h"
   2:Src/foc.c     **** #include "tim.h"
   3:Src/foc.c     **** #include "math.h"
   4:Src/foc.c     **** #include "arm_math.h"
   5:Src/foc.c     **** #include "adc.h"
   6:Src/foc.c     **** #include "as5047.h"
   7:Src/foc.c     **** #include "uart_ext.h"
   8:Src/foc.c     **** 
   9:Src/foc.c     **** #include "music_and_voice.h"
  10:Src/foc.c     **** 
  11:Src/foc.c     **** static void SVPWM(float Target_U, float duty);
  12:Src/foc.c     **** static void Test_Direction();
  13:Src/foc.c     **** static void Measure_R_MS_Handler(float duty);
  14:Src/foc.c     **** static void Measure_R_20Khz_Handler();
  15:Src/foc.c     **** 
  16:Src/foc.c     **** static void SVPWM_Step(CCR_Duty duty);
  17:Src/foc.c     **** 
  18:Src/foc.c     **** #define MIN(a, b) a < b ? a : b
  19:Src/foc.c     **** 
  20:Src/foc.c     **** uint16_t ADC_Values_Raw[4];
  21:Src/foc.c     **** uint16_t ADC_Values_Raw2[4];
  22:Src/foc.c     **** float Ialpha, Ibeta;
  23:Src/foc.c     **** 
  24:Src/foc.c     **** typedef struct
  25:Src/foc.c     **** {
  26:Src/foc.c     ****     uint8_t pairs;
  27:Src/foc.c     ****     float R;
  28:Src/foc.c     ****     float L;
  29:Src/foc.c     ****     int8_t direction;
  30:Src/foc.c     ****     // ÁîµÊú∫ÁöÑËøêËΩ¨ÊñπÂêëÔºåÁ∫¶ÂÆöÂú®ÂºÄÁéØÊ®°Âºè‰∏ãÔºåÁîµÊú∫Êåâu4->u6ÊñπÂêëËøêË°åÔºàÁîµËßíÂ∫¶Â¢
  31:Src/foc.c     ****     // Ê≠§ÂèÇÊï∞‰∏éÁîµÊú∫ a b c ‰∏âÁõ∏ÁöÑÁÑäÊé•ÊúâÂÖ≥
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 2


  32:Src/foc.c     ****     // Ê≠§ÂèÇÊï∞‰ªÖÂú®ÊúâÊÑüÊ®°Âºè‰∏≠(SENSOR_FOC)ÊúâÁî®
  33:Src/foc.c     **** } Motor_Info;
  34:Src/foc.c     **** 
  35:Src/foc.c     **** enum _board_mode Board_Mode;
  36:Src/foc.c     **** 
  37:Src/foc.c     **** struct
  38:Src/foc.c     **** {
  39:Src/foc.c     ****     uint32_t time; // unit:ms
  40:Src/foc.c     ****     float last_position;
  41:Src/foc.c     ****     int direction_result;
  42:Src/foc.c     **** } Test_Direction_Info;
  43:Src/foc.c     **** 
  44:Src/foc.c     **** Motor_Info Motor = {7, 0, 0};
  45:Src/foc.c     **** 
  46:Src/foc.c     **** Uvect_Mos U0 = {0, 0, 0, 0};
  47:Src/foc.c     **** Uvect_Mos U4 = {1, 0, 0, 0};
  48:Src/foc.c     **** Uvect_Mos U6 = {1, 1, 0, PI / 3};
  49:Src/foc.c     **** Uvect_Mos U2 = {0, 1, 0, PI / 3 * 2};
  50:Src/foc.c     **** Uvect_Mos U3 = {0, 1, 1, PI};
  51:Src/foc.c     **** Uvect_Mos U1 = {0, 0, 1, PI / 3 * 4};
  52:Src/foc.c     **** Uvect_Mos U5 = {1, 0, 1, PI / 3 * 5};
  53:Src/foc.c     **** Uvect_Mos U7 = {1, 1, 1, 0};
  54:Src/foc.c     **** 
  55:Src/foc.c     **** Uvect_Mos *Uvects[6] = {&U1, &U2, &U3, &U4, &U5, &U6};
  56:Src/foc.c     **** 
  57:Src/foc.c     **** static float theta = 0;
  58:Src/foc.c     **** float RPS = 6; // ËΩ¨ÈÄü
  59:Src/foc.c     **** 
  60:Src/foc.c     **** float Position_Degree;
  61:Src/foc.c     **** 
  62:Src/foc.c     **** float Position_Offset = 215.793457f;
  63:Src/foc.c     **** //float Position_Offset=273.164062f;
  64:Src/foc.c     **** 
  65:Src/foc.c     **** #define TIM7_FREQ 1000
  66:Src/foc.c     **** #define TIM8_FREQ 20000
  67:Src/foc.c     **** 
  68:Src/foc.c     **** #define DRIVE
  69:Src/foc.c     **** 
  70:Src/foc.c     **** static void UVects_Init()
  71:Src/foc.c     **** {
  72:Src/foc.c     ****     for (int i = 0; i < 6; ++i)
  73:Src/foc.c     ****     {
  74:Src/foc.c     ****         float v_theta = Uvects[i]->theta;
  75:Src/foc.c     ****         Uvects[i]->x = cosf(v_theta);
  76:Src/foc.c     ****         Uvects[i]->y = sinf(v_theta);
  77:Src/foc.c     ****     }
  78:Src/foc.c     **** }
  79:Src/foc.c     **** 
  80:Src/foc.c     **** void Foc_Init(float rps)
  81:Src/foc.c     **** {
  82:Src/foc.c     ****     // rps unit is r/s
  83:Src/foc.c     ****     Board_Mode = VOICE_MODE;
  84:Src/foc.c     ****     TIM8->ARR = 168000000 / TIM8_FREQ / 2;
  85:Src/foc.c     **** 
  86:Src/foc.c     ****     TIM8->CCR4 = TIM8->ARR - 2;
  87:Src/foc.c     **** 
  88:Src/foc.c     ****     UVects_Init();
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 3


  89:Src/foc.c     **** #ifdef DRIVE
  90:Src/foc.c     ****     HAL_TIM_PWM_Start(&htim8, TIM_CHANNEL_1);
  91:Src/foc.c     ****     HAL_TIM_PWM_Start(&htim8, TIM_CHANNEL_2);
  92:Src/foc.c     ****     HAL_TIM_PWM_Start(&htim8, TIM_CHANNEL_3);
  93:Src/foc.c     **** 
  94:Src/foc.c     ****     HAL_TIMEx_PWMN_Start(&htim8, TIM_CHANNEL_1);
  95:Src/foc.c     ****     HAL_TIMEx_PWMN_Start(&htim8, TIM_CHANNEL_2);
  96:Src/foc.c     ****     HAL_TIMEx_PWMN_Start(&htim8, TIM_CHANNEL_3);
  97:Src/foc.c     **** #endif
  98:Src/foc.c     ****     TIM7->PSC = 6;
  99:Src/foc.c     ****     TIM7->ARR = 12000000 / 250 - 1;
 100:Src/foc.c     **** 
 101:Src/foc.c     ****     //TIM7->PSC = 1;
 102:Src/foc.c     ****     //TIM7->ARR = 42000000 / TIM7_FREQ - 1;
 103:Src/foc.c     **** 
 104:Src/foc.c     ****     HAL_TIM_Base_Start_IT(&htim7);
 105:Src/foc.c     ****     HAL_TIM_Base_Start_IT(&htim6);
 106:Src/foc.c     ****     HAL_TIM_Base_Start(&htim8);
 107:Src/foc.c     **** }
 108:Src/foc.c     **** 
 109:Src/foc.c     **** uint8_t get_area(uint32_t now_theta)
 110:Src/foc.c     **** {
 111:Src/foc.c     ****     return now_theta / 60 + 1;
 112:Src/foc.c     **** }
 113:Src/foc.c     **** 
 114:Src/foc.c     **** // Ê†πÊçÆÊâáÂå∫Âè∑ÔºåËé∑ÂèñËØ•ÊâáÂå∫ÁöÑ‰∏§‰∏™ÁîµÂéãÁü¢Èáè
 115:Src/foc.c     **** // area:1-6
 116:Src/foc.c     **** void get_area_u(uint8_t area, Uvect_Mos *u1, Uvect_Mos *u2)
 117:Src/foc.c     **** {
 118:Src/foc.c     ****     switch (area)
 119:Src/foc.c     ****     {
 120:Src/foc.c     ****     case 1:
 121:Src/foc.c     ****         *u1 = U4;
 122:Src/foc.c     ****         *u2 = U6;
 123:Src/foc.c     ****         break;
 124:Src/foc.c     ****     case 2:
 125:Src/foc.c     ****         *u1 = U6;
 126:Src/foc.c     ****         *u2 = U2;
 127:Src/foc.c     ****         break;
 128:Src/foc.c     ****     case 3:
 129:Src/foc.c     ****         *u1 = U2;
 130:Src/foc.c     ****         *u2 = U3;
 131:Src/foc.c     ****         break;
 132:Src/foc.c     ****     case 4:
 133:Src/foc.c     ****         *u1 = U3;
 134:Src/foc.c     ****         *u2 = U1;
 135:Src/foc.c     ****         break;
 136:Src/foc.c     ****     case 5:
 137:Src/foc.c     ****         *u1 = U1;
 138:Src/foc.c     ****         *u2 = U5;
 139:Src/foc.c     ****         break;
 140:Src/foc.c     ****     case 6:
 141:Src/foc.c     ****         *u1 = U5;
 142:Src/foc.c     ****         *u2 = U4;
 143:Src/foc.c     ****         break;
 144:Src/foc.c     ****     default:
 145:Src/foc.c     ****         break;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 4


 146:Src/foc.c     ****     }
 147:Src/foc.c     **** }
 148:Src/foc.c     **** 
 149:Src/foc.c     **** /*
 150:Src/foc.c     ****     Ê†πÊçÆthetaÊù•ËÆ°ÁÆóÁõ∏ÈÇª‰∏§‰∏™Áü¢ÈáèÁöÑ‰ΩúÁî®Êó∂Èó¥ÁöÑÂáΩÊï∞Ôºå
 151:Src/foc.c     ****     Âõ†‰∏∫Áî®Âà∞Èô§Ê≥ïÊ¨°Êï∞Â§ö‰∫Ü‰∏ÄÁÇπÔºåÁõÆÂâçÊöÇÊó∂Â∫üÂºÉ„ÄÇ
 152:Src/foc.c     **** */
 153:Src/foc.c     **** void get_t(float theta, float *t1, float *t2)
 154:Src/foc.c     **** {
 155:Src/foc.c     ****     /*
 156:Src/foc.c     **** /       u2y x               u2x y       \
 157:Src/foc.c     **** | ----------------- - ----------------- |
 158:Src/foc.c     **** | u1x u2y - u2x u1y   u1x u2y - u2x u1y |
 159:Src/foc.c     **** |                                       |
 160:Src/foc.c     **** |       u1x y               u1y x       |
 161:Src/foc.c     **** | ----------------- - ----------------- |
 162:Src/foc.c     **** \ u1x u2y - u2x u1y   u1x u2y - u2x u1y /
 163:Src/foc.c     **** */
 164:Src/foc.c     ****     float temp_t1, temp_t2;
 165:Src/foc.c     ****     float theta_f; // Âçï‰Ωç‰∏∫rad
 166:Src/foc.c     ****     Uvect_Mos u1, u2;
 167:Src/foc.c     ****     float x, y;
 168:Src/foc.c     ****     get_area_u(get_area(theta), &u1, &u2);
 169:Src/foc.c     ****     //theta_f=(float)theta*2.0f*PI/360;
 170:Src/foc.c     ****     arm_sin_cos_f32(theta, &y, &x);
 171:Src/foc.c     ****     x *= 0.86f;
 172:Src/foc.c     ****     y *= 0.86f; // sqrt(3)/2 Ê≤°Èîô
 173:Src/foc.c     ****     //x=0.86f*cosf(theta_f);
 174:Src/foc.c     ****     //y=0.86f*sinf(theta_f);
 175:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 176:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 177:Src/foc.c     **** 
 178:Src/foc.c     ****     *t1 = temp_t1;
 179:Src/foc.c     ****     *t2 = temp_t2;
 180:Src/foc.c     **** }
 181:Src/foc.c     **** 
 182:Src/foc.c     **** CCR_Duty get_ccr_duty(float t1, float t2, Uvect_Mos u1, Uvect_Mos u2)
 183:Src/foc.c     **** {
 184:Src/foc.c     ****     float t0, t3;
 185:Src/foc.c     ****     CCR_Duty result;
 186:Src/foc.c     ****     t0 = (1 - t1 - t2) / 2;
 187:Src/foc.c     ****     t3 = t0;
 188:Src/foc.c     **** 
 189:Src/foc.c     ****     result.ccra = U7.a * t3 + u1.a * t1 + u2.a * t2;
 190:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 191:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 192:Src/foc.c     **** 
 193:Src/foc.c     ****     return result;
 194:Src/foc.c     **** }
 195:Src/foc.c     **** 
 196:Src/foc.c     **** static void SVPWM_Step(CCR_Duty duty)
 197:Src/foc.c     **** {
  28              		.loc 1 197 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 16
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 5


  33 0000 84B0     		sub	sp, sp, #16
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 16
  36 0002 8DED010A 		vstr.32	s0, [sp, #4]
  37 0006 CDED020A 		vstr.32	s1, [sp, #8]
  38 000a 8DED031A 		vstr.32	s2, [sp, #12]
 198:Src/foc.c     ****     TIM8->CCR1 = duty.ccrc * TIM8->ARR;
  39              		.loc 1 198 5 view .LVU1
  40              		.loc 1 198 34 is_stmt 0 view .LVU2
  41 000e 124B     		ldr	r3, .L3
  42 0010 D3ED0B7A 		vldr.32	s15, [r3, #44]	@ int
  43              		.loc 1 198 28 view .LVU3
  44 0014 F8EE677A 		vcvt.f32.u32	s15, s15
  45 0018 27EE811A 		vmul.f32	s2, s15, s2
  46              		.loc 1 198 16 view .LVU4
  47 001c BCEEC11A 		vcvt.u32.f32	s2, s2
  48 0020 83ED0D1A 		vstr.32	s2, [r3, #52]	@ int
 199:Src/foc.c     ****     TIM8->CCR2 = duty.ccrb * TIM8->ARR;
  49              		.loc 1 199 5 is_stmt 1 view .LVU5
  50              		.loc 1 199 34 is_stmt 0 view .LVU6
  51 0024 D3ED0B7A 		vldr.32	s15, [r3, #44]	@ int
  52              		.loc 1 199 28 view .LVU7
  53 0028 F8EE677A 		vcvt.f32.u32	s15, s15
  54 002c 9DED027A 		vldr.32	s14, [sp, #8]
  55 0030 67EE877A 		vmul.f32	s15, s15, s14
  56              		.loc 1 199 16 view .LVU8
  57 0034 FCEEE77A 		vcvt.u32.f32	s15, s15
  58 0038 C3ED0E7A 		vstr.32	s15, [r3, #56]	@ int
 200:Src/foc.c     ****     TIM8->CCR3 = duty.ccra * TIM8->ARR;
  59              		.loc 1 200 5 is_stmt 1 view .LVU9
  60              		.loc 1 200 34 is_stmt 0 view .LVU10
  61 003c D3ED0B7A 		vldr.32	s15, [r3, #44]	@ int
  62              		.loc 1 200 28 view .LVU11
  63 0040 F8EE677A 		vcvt.f32.u32	s15, s15
  64 0044 9DED017A 		vldr.32	s14, [sp, #4]
  65 0048 67EE877A 		vmul.f32	s15, s15, s14
  66              		.loc 1 200 16 view .LVU12
  67 004c FCEEE77A 		vcvt.u32.f32	s15, s15
  68 0050 C3ED0F7A 		vstr.32	s15, [r3, #60]	@ int
 201:Src/foc.c     **** }
  69              		.loc 1 201 1 view .LVU13
  70 0054 04B0     		add	sp, sp, #16
  71              	.LCFI1:
  72              		.cfi_def_cfa_offset 0
  73              		@ sp needed
  74 0056 7047     		bx	lr
  75              	.L4:
  76              		.align	2
  77              	.L3:
  78 0058 00040140 		.word	1073808384
  79              		.cfi_endproc
  80              	.LFE172:
  82              		.section	.text.Measure_R_20Khz_Handler,"ax",%progbits
  83              		.align	1
  84              		.syntax unified
  85              		.thumb
  86              		.thumb_func
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 6


  87              		.fpu fpv4-sp-d16
  89              	Measure_R_20Khz_Handler:
  90              	.LFB185:
 202:Src/foc.c     **** 
 203:Src/foc.c     **** /*
 204:Src/foc.c     ****     Â∞ÜÁîµÂéãÁü¢ÈáèËÆæÁΩÆ‰∏∫U4ÔºåÂπ∂ÊåÅÁª≠‰∏ÄÊÆµÊó∂Èó¥
 205:Src/foc.c     **** */
 206:Src/foc.c     **** void Set_to_U4(uint8_t t)
 207:Src/foc.c     **** {
 208:Src/foc.c     ****     CCR_Duty temp_duty = {0};
 209:Src/foc.c     ****     temp_duty.ccra = U4.a;
 210:Src/foc.c     ****     temp_duty.ccrb = U4.b;
 211:Src/foc.c     ****     temp_duty.ccrc = U4.c;
 212:Src/foc.c     ****     SVPWM_Step(temp_duty);
 213:Src/foc.c     ****     HAL_Delay(t);
 214:Src/foc.c     ****     temp_duty.ccra = U0.a;
 215:Src/foc.c     ****     temp_duty.ccrb = U0.b;
 216:Src/foc.c     ****     temp_duty.ccrc = U0.c;
 217:Src/foc.c     ****     SVPWM_Step(temp_duty);
 218:Src/foc.c     ****     uprintf("position:%f \r\n", Position_Degree);
 219:Src/foc.c     **** }
 220:Src/foc.c     **** 
 221:Src/foc.c     **** extern uint8_t Init_OK;
 222:Src/foc.c     **** void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim)
 223:Src/foc.c     **** {
 224:Src/foc.c     **** 
 225:Src/foc.c     ****     if (htim->Instance == TIM7)
 226:Src/foc.c     ****     {
 227:Src/foc.c     ****         if (!Init_OK)
 228:Src/foc.c     ****         {
 229:Src/foc.c     ****             return;
 230:Src/foc.c     ****         }
 231:Src/foc.c     ****         Theta_Handler();
 232:Src/foc.c     ****     }
 233:Src/foc.c     ****     else if (htim->Instance==TIM6){
 234:Src/foc.c     ****         if(Board_Mode!=VOICE_MODE){
 235:Src/foc.c     ****             return ;
 236:Src/foc.c     ****         }
 237:Src/foc.c     ****         //Voice_Fshz_Handler();
 238:Src/foc.c     ****     }
 239:Src/foc.c     ****     else if (htim->Instance == TIM8)
 240:Src/foc.c     ****     {
 241:Src/foc.c     ****     }
 242:Src/foc.c     **** }
 243:Src/foc.c     **** 
 244:Src/foc.c     **** void SVPWM_Normal_CalT1T2(float alpha, float beta, uint8_t area, float *t1, float *t2)
 245:Src/foc.c     **** {
 246:Src/foc.c     ****     float temp = 0;
 247:Src/foc.c     ****     switch (area)
 248:Src/foc.c     ****     {
 249:Src/foc.c     ****     case 1:
 250:Src/foc.c     ****         *t1 = alpha - 0.57735f * beta;
 251:Src/foc.c     ****         *t2 = 1.1547f * beta;
 252:Src/foc.c     ****         break;
 253:Src/foc.c     ****     case 2:
 254:Src/foc.c     ****         *t1 = alpha + 0.57735f * beta;
 255:Src/foc.c     ****         *t2 = 0.57735f * beta - alpha;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 7


 256:Src/foc.c     ****         break;
 257:Src/foc.c     ****     case 3:
 258:Src/foc.c     ****         *t1 = 1.1547f * beta;
 259:Src/foc.c     ****         *t2 = -alpha - 0.57735f * beta;
 260:Src/foc.c     ****         break;
 261:Src/foc.c     ****     case 4:
 262:Src/foc.c     ****         *t1 = 0.57735f * beta - alpha;
 263:Src/foc.c     ****         *t2 = -1.1547f * beta;
 264:Src/foc.c     ****         break;
 265:Src/foc.c     ****     case 5:
 266:Src/foc.c     ****         temp = -0.57735f * beta;
 267:Src/foc.c     ****         *t1 = temp - alpha;
 268:Src/foc.c     ****         *t2 = temp + alpha;
 269:Src/foc.c     ****         break;
 270:Src/foc.c     ****     case 6:
 271:Src/foc.c     ****         *t1 = -1.1547f * beta;
 272:Src/foc.c     ****         *t2 = alpha + 0.57735f * beta;
 273:Src/foc.c     ****         break;
 274:Src/foc.c     ****     }
 275:Src/foc.c     **** }
 276:Src/foc.c     **** 
 277:Src/foc.c     **** void Theta_Handler()
 278:Src/foc.c     **** {
 279:Src/foc.c     **** 
 280:Src/foc.c     ****     Position_Degree = Get_Position_Rad_Dgree(1);
 281:Src/foc.c     ****     switch (Board_Mode)
 282:Src/foc.c     ****     {
 283:Src/foc.c     ****     case SENSOR_FOC:
 284:Src/foc.c     ****         Foc();
 285:Src/foc.c     ****         break;
 286:Src/foc.c     ****     case VF_OPENLOOP:
 287:Src/foc.c     ****         VF_Openloop_Control(1, 1000, 1, 3);
 288:Src/foc.c     ****         break;
 289:Src/foc.c     ****     case TEST_DIRECTION:
 290:Src/foc.c     ****         Test_Direction();
 291:Src/foc.c     ****         break;
 292:Src/foc.c     ****     case STOP_MODE:
 293:Src/foc.c     ****         SVPWM(0, 0);
 294:Src/foc.c     ****         break;
 295:Src/foc.c     ****     case WAIT_MODE:
 296:Src/foc.c     ****         //  nothing to do
 297:Src/foc.c     ****         break;
 298:Src/foc.c     ****     case MEASURE_R:
 299:Src/foc.c     ****         Measure_R_MS_Handler(1);
 300:Src/foc.c     ****         break;
 301:Src/foc.c     ****     case VOICE_MODE:
 302:Src/foc.c     ****         break;
 303:Src/foc.c     ****     case SING_MODE:
 304:Src/foc.c     ****         Muisc_Play_TIM_IRQ_Handler();
 305:Src/foc.c     ****         break;
 306:Src/foc.c     ****     default:
 307:Src/foc.c     ****         break;
 308:Src/foc.c     ****     }
 309:Src/foc.c     **** }
 310:Src/foc.c     **** 
 311:Src/foc.c     **** #define ADC_RAW2_CURRENT(raw) raw * 3300.0f / 4096 / 200 / 0.003f
 312:Src/foc.c     **** 
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 8


 313:Src/foc.c     **** void Park_Conv(float ia, float ib, float *ialpha, float *ibeta)
 314:Src/foc.c     **** {
 315:Src/foc.c     ****     *ialpha = ia;
 316:Src/foc.c     ****     *ibeta = (sqrtf(3) * ib + sqrtf(3) * (ib + ia)) / 3.0f;
 317:Src/foc.c     **** }
 318:Src/foc.c     **** 
 319:Src/foc.c     **** void HAL_ADC_ConvCpltCallback(ADC_HandleTypeDef *hadc)
 320:Src/foc.c     **** {
 321:Src/foc.c     ****     float ia, ib;
 322:Src/foc.c     **** 
 323:Src/foc.c     ****     if (hadc->Instance == ADC1)
 324:Src/foc.c     ****     {
 325:Src/foc.c     ****     }
 326:Src/foc.c     ****     else if (hadc->Instance == ADC2)
 327:Src/foc.c     ****     {
 328:Src/foc.c     ****         if (Board_Mode == SENSOR_FOC)
 329:Src/foc.c     ****         {
 330:Src/foc.c     ****             ia = ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
 331:Src/foc.c     ****             ib = ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 332:Src/foc.c     ****             Park_Conv(ia, ib, &Ialpha, &Ibeta);
 333:Src/foc.c     ****         }
 334:Src/foc.c     ****         Measure_R_20Khz_Handler();
 335:Src/foc.c     ****     }
 336:Src/foc.c     **** }
 337:Src/foc.c     **** 
 338:Src/foc.c     **** void Foc()
 339:Src/foc.c     **** {
 340:Src/foc.c     ****     Uvect_Mos u1, u2;
 341:Src/foc.c     ****     float t1, t2;
 342:Src/foc.c     ****     float x, y;
 343:Src/foc.c     **** 
 344:Src/foc.c     ****     float electric_position = (-1 * Position_Degree + 360);
 345:Src/foc.c     ****     float electric_position_offset = (-1 * Position_Offset + 360);
 346:Src/foc.c     ****     //float electric_position=Position_Degree;
 347:Src/foc.c     ****     //float electric_position_offset=Position_Offset;
 348:Src/foc.c     ****     int32_t sub = (int32_t)(electric_position - electric_position_offset);
 349:Src/foc.c     **** 
 350:Src/foc.c     ****     if (sub < 0)
 351:Src/foc.c     ****     {
 352:Src/foc.c     ****         sub += 360;
 353:Src/foc.c     ****     }
 354:Src/foc.c     ****     sub *= Motor.pairs;
 355:Src/foc.c     ****     sub += 90;
 356:Src/foc.c     **** 
 357:Src/foc.c     ****     sub %= 360;
 358:Src/foc.c     **** 
 359:Src/foc.c     ****     SVPWM(sub, 1);
 360:Src/foc.c     **** }
 361:Src/foc.c     **** 
 362:Src/foc.c     **** // Target_U ÊúüÊúõÁîµÂéãÁü¢ÈáèÁöÑËßíÂ∫¶ Âçï‰Ωç¬∞ 0-360
 363:Src/foc.c     **** // duty ÊúüÊúõÂç†Á©∫ÊØî 0-1
 364:Src/foc.c     **** static void SVPWM(float Target_U, float duty)
 365:Src/foc.c     **** {
 366:Src/foc.c     ****     Uvect_Mos u1, u2;
 367:Src/foc.c     ****     float x, y;
 368:Src/foc.c     ****     float t1, t2;
 369:Src/foc.c     ****     static CCR_Duty CCR_Dutys = {0};
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 9


 370:Src/foc.c     **** 
 371:Src/foc.c     ****     uint8_t area = get_area(Target_U);
 372:Src/foc.c     ****     get_area_u(area, &u1, &u2);
 373:Src/foc.c     ****     arm_sin_cos_f32(Target_U, &y, &x);
 374:Src/foc.c     ****     x *= 0.86f * duty;
 375:Src/foc.c     ****     y *= 0.86f * duty; // sqrt(3)/2 Ê≤°Èîô
 376:Src/foc.c     ****     SVPWM_Normal_CalT1T2(x, y, area, &t1, &t2);
 377:Src/foc.c     ****     CCR_Dutys = get_ccr_duty(t1, t2, u1, u2);
 378:Src/foc.c     ****     SVPWM_Step(CCR_Dutys);
 379:Src/foc.c     **** }
 380:Src/foc.c     **** 
 381:Src/foc.c     **** void VF_Openloop_Control(float duty, float freq, int8_t direction, float rps)
 382:Src/foc.c     **** {
 383:Src/foc.c     ****     static float theta = 0;
 384:Src/foc.c     ****     float delta_p = rps * Motor.pairs * 360.0f / freq; // ÊØèÊ¨°Ë∞ÉÁî®Êú¨ÂáΩÊï∞Ë¶ÅÂ¢ûÂä†ÁöÑÂÄº
 385:Src/foc.c     **** 
 386:Src/foc.c     ****     theta += direction * delta_p;
 387:Src/foc.c     ****     if (theta > 360)
 388:Src/foc.c     ****     {
 389:Src/foc.c     ****         theta -= 360;
 390:Src/foc.c     ****     }
 391:Src/foc.c     ****     else if (theta < 0)
 392:Src/foc.c     ****     {
 393:Src/foc.c     ****         theta += 360;
 394:Src/foc.c     ****     }
 395:Src/foc.c     ****     SVPWM(theta, duty);
 396:Src/foc.c     **** }
 397:Src/foc.c     **** 
 398:Src/foc.c     **** static void Test_Direction()
 399:Src/foc.c     **** {
 400:Src/foc.c     ****     Test_Direction_Info.time += 1;
 401:Src/foc.c     **** 
 402:Src/foc.c     ****     if (Position_Degree > Test_Direction_Info.last_position)
 403:Src/foc.c     ****     {
 404:Src/foc.c     ****         Test_Direction_Info.direction_result += 1;
 405:Src/foc.c     ****     }
 406:Src/foc.c     ****     else
 407:Src/foc.c     ****     {
 408:Src/foc.c     ****         Test_Direction_Info.direction_result -= 1;
 409:Src/foc.c     ****     }
 410:Src/foc.c     ****     Test_Direction_Info.last_position = Position_Degree;
 411:Src/foc.c     **** 
 412:Src/foc.c     ****     VF_Openloop_Control(1, 1000, 1, 1);
 413:Src/foc.c     **** 
 414:Src/foc.c     ****     if (Test_Direction_Info.time > 10000)
 415:Src/foc.c     ****     { // run 10s
 416:Src/foc.c     ****         Board_Mode = STOP_MODE;
 417:Src/foc.c     ****         Test_Direction_Info.time = 0;
 418:Src/foc.c     ****         uprintf_polling("direction result:%d\r\n", Test_Direction_Info.direction_result);
 419:Src/foc.c     ****         if (Test_Direction_Info.direction_result > 0)
 420:Src/foc.c     ****         {
 421:Src/foc.c     ****             uprintf_polling("the direction of the motor is postive!\r\n");
 422:Src/foc.c     ****             Motor.direction = 1;
 423:Src/foc.c     ****         }
 424:Src/foc.c     ****         else
 425:Src/foc.c     ****         {
 426:Src/foc.c     ****             uprintf_polling("the direction of the motor is nagative!\r\n");
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 10


 427:Src/foc.c     ****             Motor.direction = -1;
 428:Src/foc.c     ****         }
 429:Src/foc.c     ****         Test_Direction_Info.direction_result = 0;
 430:Src/foc.c     ****     }
 431:Src/foc.c     **** }
 432:Src/foc.c     **** 
 433:Src/foc.c     **** struct
 434:Src/foc.c     **** {
 435:Src/foc.c     ****     uint32_t time; //unit:ms
 436:Src/foc.c     ****     Uvect_Mos *Used_Mos;
 437:Src/foc.c     ****     uint32_t cnt;
 438:Src/foc.c     ****     uint32_t USELESS_CNT;
 439:Src/foc.c     ****     uint32_t CNT_MAX;
 440:Src/foc.c     ****     float current_sum;
 441:Src/foc.c     **** } Measure_R_Info;
 442:Src/foc.c     **** 
 443:Src/foc.c     **** void Set_Vector(Uvect_Mos u, float duty)
 444:Src/foc.c     **** {
 445:Src/foc.c     ****     CCR_Duty temp_duty = {0};
 446:Src/foc.c     ****     if(duty>0.95f){
 447:Src/foc.c     ****         duty=0.95f;
 448:Src/foc.c     ****     }
 449:Src/foc.c     **** 
 450:Src/foc.c     ****     temp_duty.ccra = u.a * duty; //011
 451:Src/foc.c     ****     temp_duty.ccrb = u.b * duty;
 452:Src/foc.c     ****     temp_duty.ccrc = u.c * duty;
 453:Src/foc.c     **** 
 454:Src/foc.c     ****     SVPWM_Step(temp_duty);
 455:Src/foc.c     **** }
 456:Src/foc.c     **** 
 457:Src/foc.c     **** static void Measure_R_MS_Handler(float duty)
 458:Src/foc.c     **** {
 459:Src/foc.c     ****     CCR_Duty temp_duty = {0};
 460:Src/foc.c     ****     static float current1 = 0;
 461:Src/foc.c     ****     static float current2 = 0;
 462:Src/foc.c     ****     float cur_avg = 0;
 463:Src/foc.c     ****     if (Measure_R_Info.time == 0)
 464:Src/foc.c     ****     {
 465:Src/foc.c     ****         Measure_R_Info.Used_Mos = &U5;
 466:Src/foc.c     ****         Measure_R_Info.USELESS_CNT = 2;
 467:Src/foc.c     ****         Measure_R_Info.CNT_MAX = 30;
 468:Src/foc.c     **** 
 469:Src/foc.c     ****         temp_duty.ccra = Measure_R_Info.Used_Mos->a * duty; //011
 470:Src/foc.c     ****         temp_duty.ccrb = Measure_R_Info.Used_Mos->b * duty;
 471:Src/foc.c     ****         temp_duty.ccrc = Measure_R_Info.Used_Mos->c * duty;
 472:Src/foc.c     ****         SVPWM_Step(temp_duty);
 473:Src/foc.c     **** 
 474:Src/foc.c     ****         //Set_Vector(*Measure_R_Info.Used_Mos,duty);
 475:Src/foc.c     ****         Measure_R_Info.time = 1;
 476:Src/foc.c     **** 
 477:Src/foc.c     ****         return;
 478:Src/foc.c     ****     }
 479:Src/foc.c     **** 
 480:Src/foc.c     ****     Measure_R_Info.time += 1;
 481:Src/foc.c     **** 
 482:Src/foc.c     ****     // ËøôÈáåÁöÑÁîµÊµÅ‰ªÖÁî®‰∫éÊµãËØïÈááÊ†∑Áõ∏ÊòØÂê¶Ê≠£Á°Æ
 483:Src/foc.c     ****     current1 += ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 11


 484:Src/foc.c     ****     current2 += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 485:Src/foc.c     **** 
 486:Src/foc.c     ****     if (Measure_R_Info.time >= 3)
 487:Src/foc.c     ****     {
 488:Src/foc.c     ****         uprintf_polling("duty:%f current1:%f  current2:%f\r\n", duty, current1, current2);
 489:Src/foc.c     ****         current1 = 0;
 490:Src/foc.c     ****         current2 = 0;
 491:Src/foc.c     ****         Board_Mode = STOP_MODE;
 492:Src/foc.c     ****         Measure_R_Info.time = 0;
 493:Src/foc.c     **** 
 494:Src/foc.c     ****         if (Measure_R_Info.cnt < Measure_R_Info.CNT_MAX)
 495:Src/foc.c     ****         {
 496:Src/foc.c     ****             uprintf_polling("error! no enough time! %d \r\n", Measure_R_Info.cnt);
 497:Src/foc.c     ****         }
 498:Src/foc.c     ****         else
 499:Src/foc.c     ****         {
 500:Src/foc.c     ****             cur_avg = Measure_R_Info.current_sum / (Measure_R_Info.CNT_MAX - Measure_R_Info.USELESS
 501:Src/foc.c     ****             uprintf_polling("current_avg:%f cnt:%d \r\n", cur_avg, Measure_R_Info.cnt);
 502:Src/foc.c     ****         }
 503:Src/foc.c     ****         Measure_R_Info.current_sum = 0;
 504:Src/foc.c     ****         Measure_R_Info.cnt = 0;
 505:Src/foc.c     ****     }
 506:Src/foc.c     **** }
 507:Src/foc.c     **** 
 508:Src/foc.c     **** static void Measure_R_20Khz_Handler()
 509:Src/foc.c     **** {
  91              		.loc 1 509 1 is_stmt 1 view -0
  92              		.cfi_startproc
  93              		@ args = 0, pretend = 0, frame = 0
  94              		@ frame_needed = 0, uses_anonymous_args = 0
  95              		@ link register save eliminated.
 510:Src/foc.c     ****     if (Board_Mode != MEASURE_R)
  96              		.loc 1 510 5 view .LVU15
  97              		.loc 1 510 20 is_stmt 0 view .LVU16
  98 0000 2B4B     		ldr	r3, .L10
  99 0002 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 100              		.loc 1 510 8 view .LVU17
 101 0004 052B     		cmp	r3, #5
 102 0006 15D1     		bne	.L5
 511:Src/foc.c     ****     {
 512:Src/foc.c     ****         return;
 513:Src/foc.c     ****     }
 514:Src/foc.c     **** 
 515:Src/foc.c     ****     if (Measure_R_Info.time < 1)
 103              		.loc 1 515 5 is_stmt 1 view .LVU18
 104              		.loc 1 515 23 is_stmt 0 view .LVU19
 105 0008 2A4B     		ldr	r3, .L10+4
 106 000a 1B68     		ldr	r3, [r3]
 107              		.loc 1 515 8 view .LVU20
 108 000c 93B1     		cbz	r3, .L5
 516:Src/foc.c     ****     {
 517:Src/foc.c     ****         return;
 518:Src/foc.c     ****     }
 519:Src/foc.c     ****     Measure_R_Info.cnt++;
 109              		.loc 1 519 5 is_stmt 1 view .LVU21
 110              		.loc 1 519 19 is_stmt 0 view .LVU22
 111 000e 294A     		ldr	r2, .L10+4
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 12


 112 0010 9368     		ldr	r3, [r2, #8]
 113              		.loc 1 519 23 view .LVU23
 114 0012 0133     		adds	r3, r3, #1
 115 0014 9360     		str	r3, [r2, #8]
 520:Src/foc.c     **** 
 521:Src/foc.c     ****     // eg:USELESS_CNT=5   CNT_MAX=30
 522:Src/foc.c     ****     // 5,6,7...30
 523:Src/foc.c     ****     // so times is CNT_MAX-USELESS_CNT+1
 524:Src/foc.c     ****     if (Measure_R_Info.cnt >= Measure_R_Info.USELESS_CNT && Measure_R_Info.cnt <= Measure_R_Info.CN
 116              		.loc 1 524 5 is_stmt 1 view .LVU24
 117              		.loc 1 524 45 is_stmt 0 view .LVU25
 118 0016 D268     		ldr	r2, [r2, #12]
 119              		.loc 1 524 8 view .LVU26
 120 0018 9342     		cmp	r3, r2
 121 001a 0BD3     		bcc	.L5
 122              		.loc 1 524 97 discriminator 1 view .LVU27
 123 001c 254A     		ldr	r2, .L10+4
 124 001e 1269     		ldr	r2, [r2, #16]
 125              		.loc 1 524 58 discriminator 1 view .LVU28
 126 0020 9342     		cmp	r3, r2
 127 0022 07D8     		bhi	.L5
 525:Src/foc.c     ****     {
 526:Src/foc.c     ****         if (Measure_R_Info.Used_Mos == &U3)
 128              		.loc 1 526 9 is_stmt 1 view .LVU29
 129              		.loc 1 526 27 is_stmt 0 view .LVU30
 130 0024 234B     		ldr	r3, .L10+4
 131 0026 5B68     		ldr	r3, [r3, #4]
 132              		.loc 1 526 12 view .LVU31
 133 0028 234A     		ldr	r2, .L10+8
 134 002a 9342     		cmp	r3, r2
 135 002c 03D0     		beq	.L8
 527:Src/foc.c     ****         { //011
 528:Src/foc.c     ****             Measure_R_Info.current_sum += ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
 529:Src/foc.c     ****         }
 530:Src/foc.c     ****         else if (Measure_R_Info.Used_Mos == &U5)
 136              		.loc 1 530 14 is_stmt 1 view .LVU32
 137              		.loc 1 530 17 is_stmt 0 view .LVU33
 138 002e 234A     		ldr	r2, .L10+12
 139 0030 9342     		cmp	r3, r2
 140 0032 1ED0     		beq	.L9
 141              	.L5:
 531:Src/foc.c     ****         {
 532:Src/foc.c     ****             Measure_R_Info.current_sum += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 533:Src/foc.c     ****         }
 534:Src/foc.c     ****     }
 535:Src/foc.c     **** }
 142              		.loc 1 535 1 view .LVU34
 143 0034 7047     		bx	lr
 144              	.L8:
 528:Src/foc.c     ****         }
 145              		.loc 1 528 13 is_stmt 1 view .LVU35
 528:Src/foc.c     ****         }
 146              		.loc 1 528 43 is_stmt 0 view .LVU36
 147 0036 224B     		ldr	r3, .L10+16
 148 0038 1B88     		ldrh	r3, [r3]
 149 003a 07EE903A 		vmov	s15, r3	@ int
 150 003e F8EEE77A 		vcvt.f32.s32	s15, s15
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 13


 151 0042 9FED207A 		vldr.32	s14, .L10+20
 152 0046 67EE877A 		vmul.f32	s15, s15, s14
 153 004a 9FED1F7A 		vldr.32	s14, .L10+24
 154 004e 67EE877A 		vmul.f32	s15, s15, s14
 155 0052 9FED1E7A 		vldr.32	s14, .L10+28
 156 0056 C7EE876A 		vdiv.f32	s13, s15, s14
 157 005a DFED1D7A 		vldr.32	s15, .L10+32
 158 005e 86EEA77A 		vdiv.f32	s14, s13, s15
 528:Src/foc.c     ****         }
 159              		.loc 1 528 40 view .LVU37
 160 0062 144B     		ldr	r3, .L10+4
 161 0064 D3ED057A 		vldr.32	s15, [r3, #20]
 162 0068 77EE877A 		vadd.f32	s15, s15, s14
 163 006c C3ED057A 		vstr.32	s15, [r3, #20]
 164 0070 7047     		bx	lr
 165              	.L9:
 532:Src/foc.c     ****         }
 166              		.loc 1 532 13 is_stmt 1 view .LVU38
 532:Src/foc.c     ****         }
 167              		.loc 1 532 43 is_stmt 0 view .LVU39
 168 0072 134B     		ldr	r3, .L10+16
 169 0074 5B88     		ldrh	r3, [r3, #2]
 170 0076 07EE903A 		vmov	s15, r3	@ int
 171 007a F8EEE77A 		vcvt.f32.s32	s15, s15
 172 007e 9FED117A 		vldr.32	s14, .L10+20
 173 0082 67EE877A 		vmul.f32	s15, s15, s14
 174 0086 9FED107A 		vldr.32	s14, .L10+24
 175 008a 67EE877A 		vmul.f32	s15, s15, s14
 176 008e 9FED0F7A 		vldr.32	s14, .L10+28
 177 0092 C7EE876A 		vdiv.f32	s13, s15, s14
 178 0096 DFED0E7A 		vldr.32	s15, .L10+32
 179 009a 86EEA77A 		vdiv.f32	s14, s13, s15
 532:Src/foc.c     ****         }
 180              		.loc 1 532 40 view .LVU40
 181 009e 054B     		ldr	r3, .L10+4
 182 00a0 D3ED057A 		vldr.32	s15, [r3, #20]
 183 00a4 77EE877A 		vadd.f32	s15, s15, s14
 184 00a8 C3ED057A 		vstr.32	s15, [r3, #20]
 185 00ac C2E7     		b	.L5
 186              	.L11:
 187 00ae 00BF     		.align	2
 188              	.L10:
 189 00b0 00000000 		.word	Board_Mode
 190 00b4 00000000 		.word	Measure_R_Info
 191 00b8 00000000 		.word	.LANCHOR0
 192 00bc 00000000 		.word	.LANCHOR1
 193 00c0 00000000 		.word	ADC_Values_Raw2
 194 00c4 00404E45 		.word	1162756096
 195 00c8 00008039 		.word	964689920
 196 00cc 00004843 		.word	1128792064
 197 00d0 A69B443B 		.word	994352038
 198              		.cfi_endproc
 199              	.LFE185:
 201              		.section	.text.UVects_Init,"ax",%progbits
 202              		.align	1
 203              		.syntax unified
 204              		.thumb
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 14


 205              		.thumb_func
 206              		.fpu fpv4-sp-d16
 208              	UVects_Init:
 209              	.LFB166:
  71:Src/foc.c     ****     for (int i = 0; i < 6; ++i)
 210              		.loc 1 71 1 is_stmt 1 view -0
 211              		.cfi_startproc
 212              		@ args = 0, pretend = 0, frame = 0
 213              		@ frame_needed = 0, uses_anonymous_args = 0
 214 0000 70B5     		push	{r4, r5, r6, lr}
 215              	.LCFI2:
 216              		.cfi_def_cfa_offset 16
 217              		.cfi_offset 4, -16
 218              		.cfi_offset 5, -12
 219              		.cfi_offset 6, -8
 220              		.cfi_offset 14, -4
 221 0002 2DED028B 		vpush.64	{d8}
 222              	.LCFI3:
 223              		.cfi_def_cfa_offset 24
 224              		.cfi_offset 80, -24
 225              		.cfi_offset 81, -20
  72:Src/foc.c     ****     {
 226              		.loc 1 72 5 view .LVU42
 227              	.LBB2:
  72:Src/foc.c     ****     {
 228              		.loc 1 72 10 view .LVU43
 229              	.LVL0:
  72:Src/foc.c     ****     {
 230              		.loc 1 72 14 is_stmt 0 view .LVU44
 231 0006 0024     		movs	r4, #0
 232              	.LVL1:
 233              	.L13:
  72:Src/foc.c     ****     {
 234              		.loc 1 72 21 is_stmt 1 discriminator 1 view .LVU45
  72:Src/foc.c     ****     {
 235              		.loc 1 72 5 is_stmt 0 discriminator 1 view .LVU46
 236 0008 052C     		cmp	r4, #5
 237 000a 14DC     		bgt	.L16
 238              	.LBB3:
  74:Src/foc.c     ****         Uvects[i]->x = cosf(v_theta);
 239              		.loc 1 74 9 is_stmt 1 discriminator 3 view .LVU47
  74:Src/foc.c     ****         Uvects[i]->x = cosf(v_theta);
 240              		.loc 1 74 31 is_stmt 0 discriminator 3 view .LVU48
 241 000c 0B4D     		ldr	r5, .L17
 242 000e 55F82460 		ldr	r6, [r5, r4, lsl #2]
  74:Src/foc.c     ****         Uvects[i]->x = cosf(v_theta);
 243              		.loc 1 74 15 discriminator 3 view .LVU49
 244 0012 96ED018A 		vldr.32	s16, [r6, #4]
 245              	.LVL2:
  75:Src/foc.c     ****         Uvects[i]->y = sinf(v_theta);
 246              		.loc 1 75 9 is_stmt 1 discriminator 3 view .LVU50
  75:Src/foc.c     ****         Uvects[i]->y = sinf(v_theta);
 247              		.loc 1 75 24 is_stmt 0 discriminator 3 view .LVU51
 248 0016 B0EE480A 		vmov.f32	s0, s16
 249 001a FFF7FEFF 		bl	cosf
 250              	.LVL3:
  75:Src/foc.c     ****         Uvects[i]->y = sinf(v_theta);
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 15


 251              		.loc 1 75 22 discriminator 3 view .LVU52
 252 001e 86ED020A 		vstr.32	s0, [r6, #8]
  76:Src/foc.c     ****     }
 253              		.loc 1 76 9 is_stmt 1 discriminator 3 view .LVU53
  76:Src/foc.c     ****     }
 254              		.loc 1 76 15 is_stmt 0 discriminator 3 view .LVU54
 255 0022 55F82450 		ldr	r5, [r5, r4, lsl #2]
  76:Src/foc.c     ****     }
 256              		.loc 1 76 24 discriminator 3 view .LVU55
 257 0026 B0EE480A 		vmov.f32	s0, s16
 258 002a FFF7FEFF 		bl	sinf
 259              	.LVL4:
  76:Src/foc.c     ****     }
 260              		.loc 1 76 22 discriminator 3 view .LVU56
 261 002e 85ED030A 		vstr.32	s0, [r5, #12]
 262              	.LBE3:
  72:Src/foc.c     ****     {
 263              		.loc 1 72 28 is_stmt 1 discriminator 3 view .LVU57
 264 0032 0134     		adds	r4, r4, #1
 265              	.LVL5:
  72:Src/foc.c     ****     {
 266              		.loc 1 72 28 is_stmt 0 discriminator 3 view .LVU58
 267 0034 E8E7     		b	.L13
 268              	.LVL6:
 269              	.L16:
  72:Src/foc.c     ****     {
 270              		.loc 1 72 28 discriminator 3 view .LVU59
 271              	.LBE2:
  78:Src/foc.c     **** 
 272              		.loc 1 78 1 view .LVU60
 273 0036 BDEC028B 		vldm	sp!, {d8}
 274              	.LCFI4:
 275              		.cfi_restore 80
 276              		.cfi_restore 81
 277              		.cfi_def_cfa_offset 16
 278 003a 70BD     		pop	{r4, r5, r6, pc}
 279              	.LVL7:
 280              	.L18:
  78:Src/foc.c     **** 
 281              		.loc 1 78 1 view .LVU61
 282              		.align	2
 283              	.L17:
 284 003c 00000000 		.word	.LANCHOR2
 285              		.cfi_endproc
 286              	.LFE166:
 288              		.global	__aeabi_f2d
 289              		.section	.rodata.Measure_R_MS_Handler.str1.4,"aMS",%progbits,1
 290              		.align	2
 291              	.LC0:
 292 0000 64757479 		.ascii	"duty:%f current1:%f  current2:%f\015\012\000"
 292      3A256620 
 292      63757272 
 292      656E7431 
 292      3A256620 
 293 0023 00       		.align	2
 294              	.LC1:
 295 0024 6572726F 		.ascii	"error! no enough time! %d \015\012\000"
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 16


 295      7221206E 
 295      6F20656E 
 295      6F756768 
 295      2074696D 
 296 0041 000000   		.align	2
 297              	.LC2:
 298 0044 63757272 		.ascii	"current_avg:%f cnt:%d \015\012\000"
 298      656E745F 
 298      6176673A 
 298      25662063 
 298      6E743A25 
 299              		.section	.text.Measure_R_MS_Handler,"ax",%progbits
 300              		.align	1
 301              		.syntax unified
 302              		.thumb
 303              		.thumb_func
 304              		.fpu fpv4-sp-d16
 306              	Measure_R_MS_Handler:
 307              	.LVL8:
 308              	.LFB184:
 458:Src/foc.c     ****     CCR_Duty temp_duty = {0};
 309              		.loc 1 458 1 is_stmt 1 view -0
 310              		.cfi_startproc
 311              		@ args = 0, pretend = 0, frame = 16
 312              		@ frame_needed = 0, uses_anonymous_args = 0
 458:Src/foc.c     ****     CCR_Duty temp_duty = {0};
 313              		.loc 1 458 1 is_stmt 0 view .LVU63
 314 0000 30B5     		push	{r4, r5, lr}
 315              	.LCFI5:
 316              		.cfi_def_cfa_offset 12
 317              		.cfi_offset 4, -12
 318              		.cfi_offset 5, -8
 319              		.cfi_offset 14, -4
 320 0002 2DED028B 		vpush.64	{d8}
 321              	.LCFI6:
 322              		.cfi_def_cfa_offset 20
 323              		.cfi_offset 80, -20
 324              		.cfi_offset 81, -16
 325 0006 89B0     		sub	sp, sp, #36
 326              	.LCFI7:
 327              		.cfi_def_cfa_offset 56
 328 0008 B0EE401A 		vmov.f32	s2, s0
 459:Src/foc.c     ****     static float current1 = 0;
 329              		.loc 1 459 5 is_stmt 1 view .LVU64
 460:Src/foc.c     ****     static float current2 = 0;
 330              		.loc 1 460 5 view .LVU65
 461:Src/foc.c     ****     float cur_avg = 0;
 331              		.loc 1 461 5 view .LVU66
 462:Src/foc.c     ****     if (Measure_R_Info.time == 0)
 332              		.loc 1 462 5 view .LVU67
 333              	.LVL9:
 463:Src/foc.c     ****     {
 334              		.loc 1 463 5 view .LVU68
 463:Src/foc.c     ****     {
 335              		.loc 1 463 23 is_stmt 0 view .LVU69
 336 000c 524B     		ldr	r3, .L28
 337 000e 1B68     		ldr	r3, [r3]
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 17


 463:Src/foc.c     ****     {
 338              		.loc 1 463 8 view .LVU70
 339 0010 002B     		cmp	r3, #0
 340 0012 39D0     		beq	.L26
 480:Src/foc.c     **** 
 341              		.loc 1 480 5 is_stmt 1 view .LVU71
 480:Src/foc.c     **** 
 342              		.loc 1 480 25 is_stmt 0 view .LVU72
 343 0014 0133     		adds	r3, r3, #1
 344 0016 504A     		ldr	r2, .L28
 345 0018 1360     		str	r3, [r2]
 483:Src/foc.c     ****     current2 += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 346              		.loc 1 483 5 is_stmt 1 view .LVU73
 483:Src/foc.c     ****     current2 += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 347              		.loc 1 483 17 is_stmt 0 view .LVU74
 348 001a 504A     		ldr	r2, .L28+4
 349 001c 1188     		ldrh	r1, [r2]
 350 001e 07EE101A 		vmov	s14, r1	@ int
 351 0022 B8EEC77A 		vcvt.f32.s32	s14, s14
 352 0026 DFED4E5A 		vldr.32	s11, .L28+8
 353 002a 27EE257A 		vmul.f32	s14, s14, s11
 354 002e 9FED4D6A 		vldr.32	s12, .L28+12
 355 0032 27EE067A 		vmul.f32	s14, s14, s12
 356 0036 DFED4C6A 		vldr.32	s13, .L28+16
 357 003a C7EE267A 		vdiv.f32	s15, s14, s13
 358 003e 9FED4B7A 		vldr.32	s14, .L28+20
 359 0042 87EE878A 		vdiv.f32	s16, s15, s14
 483:Src/foc.c     ****     current2 += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 360              		.loc 1 483 14 view .LVU75
 361 0046 4A49     		ldr	r1, .L28+24
 362 0048 D1ED007A 		vldr.32	s15, [r1]
 363 004c 38EE278A 		vadd.f32	s16, s16, s15
 364 0050 81ED008A 		vstr.32	s16, [r1]
 484:Src/foc.c     **** 
 365              		.loc 1 484 5 is_stmt 1 view .LVU76
 484:Src/foc.c     **** 
 366              		.loc 1 484 17 is_stmt 0 view .LVU77
 367 0054 5288     		ldrh	r2, [r2, #2]
 368 0056 07EE902A 		vmov	s15, r2	@ int
 369 005a F8EEE77A 		vcvt.f32.s32	s15, s15
 370 005e 67EEA57A 		vmul.f32	s15, s15, s11
 371 0062 67EE867A 		vmul.f32	s15, s15, s12
 372 0066 87EEA66A 		vdiv.f32	s12, s15, s13
 373 006a C6EE078A 		vdiv.f32	s17, s12, s14
 484:Src/foc.c     **** 
 374              		.loc 1 484 14 view .LVU78
 375 006e 414A     		ldr	r2, .L28+28
 376 0070 D2ED007A 		vldr.32	s15, [r2]
 377 0074 78EEA78A 		vadd.f32	s17, s17, s15
 378 0078 C2ED008A 		vstr.32	s17, [r2]
 486:Src/foc.c     ****     {
 379              		.loc 1 486 5 is_stmt 1 view .LVU79
 486:Src/foc.c     ****     {
 380              		.loc 1 486 8 is_stmt 0 view .LVU80
 381 007c 022B     		cmp	r3, #2
 382 007e 24D8     		bhi	.L27
 383              	.LVL10:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 18


 384              	.L19:
 506:Src/foc.c     **** 
 385              		.loc 1 506 1 view .LVU81
 386 0080 09B0     		add	sp, sp, #36
 387              	.LCFI8:
 388              		.cfi_remember_state
 389              		.cfi_def_cfa_offset 20
 390              		@ sp needed
 391 0082 BDEC028B 		vldm	sp!, {d8}
 392              	.LCFI9:
 393              		.cfi_restore 80
 394              		.cfi_restore 81
 395              		.cfi_def_cfa_offset 12
 396 0086 30BD     		pop	{r4, r5, pc}
 397              	.LVL11:
 398              	.L26:
 399              	.LCFI10:
 400              		.cfi_restore_state
 465:Src/foc.c     ****         Measure_R_Info.USELESS_CNT = 2;
 401              		.loc 1 465 9 is_stmt 1 view .LVU82
 465:Src/foc.c     ****         Measure_R_Info.USELESS_CNT = 2;
 402              		.loc 1 465 33 is_stmt 0 view .LVU83
 403 0088 334C     		ldr	r4, .L28
 404 008a 3B4B     		ldr	r3, .L28+32
 405 008c 6360     		str	r3, [r4, #4]
 466:Src/foc.c     ****         Measure_R_Info.CNT_MAX = 30;
 406              		.loc 1 466 9 is_stmt 1 view .LVU84
 466:Src/foc.c     ****         Measure_R_Info.CNT_MAX = 30;
 407              		.loc 1 466 36 is_stmt 0 view .LVU85
 408 008e 0222     		movs	r2, #2
 409 0090 E260     		str	r2, [r4, #12]
 467:Src/foc.c     **** 
 410              		.loc 1 467 9 is_stmt 1 view .LVU86
 467:Src/foc.c     **** 
 411              		.loc 1 467 32 is_stmt 0 view .LVU87
 412 0092 1E22     		movs	r2, #30
 413 0094 2261     		str	r2, [r4, #16]
 469:Src/foc.c     ****         temp_duty.ccrb = Measure_R_Info.Used_Mos->b * duty;
 414              		.loc 1 469 9 is_stmt 1 view .LVU88
 469:Src/foc.c     ****         temp_duty.ccrb = Measure_R_Info.Used_Mos->b * duty;
 415              		.loc 1 469 49 is_stmt 0 view .LVU89
 416 0096 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 417 0098 00EE102A 		vmov	s0, r2	@ int
 418              	.LVL12:
 469:Src/foc.c     ****         temp_duty.ccrb = Measure_R_Info.Used_Mos->b * duty;
 419              		.loc 1 469 53 view .LVU90
 420 009c B8EEC00A 		vcvt.f32.s32	s0, s0
 470:Src/foc.c     ****         temp_duty.ccrc = Measure_R_Info.Used_Mos->c * duty;
 421              		.loc 1 470 9 is_stmt 1 view .LVU91
 470:Src/foc.c     ****         temp_duty.ccrc = Measure_R_Info.Used_Mos->c * duty;
 422              		.loc 1 470 49 is_stmt 0 view .LVU92
 423 00a0 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 424 00a2 00EE902A 		vmov	s1, r2	@ int
 470:Src/foc.c     ****         temp_duty.ccrc = Measure_R_Info.Used_Mos->c * duty;
 425              		.loc 1 470 53 view .LVU93
 426 00a6 F8EEE00A 		vcvt.f32.s32	s1, s1
 471:Src/foc.c     ****         SVPWM_Step(temp_duty);
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 19


 427              		.loc 1 471 9 is_stmt 1 view .LVU94
 471:Src/foc.c     ****         SVPWM_Step(temp_duty);
 428              		.loc 1 471 49 is_stmt 0 view .LVU95
 429 00aa 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 430 00ac 07EE903A 		vmov	s15, r3	@ int
 471:Src/foc.c     ****         SVPWM_Step(temp_duty);
 431              		.loc 1 471 53 view .LVU96
 432 00b0 F8EEE77A 		vcvt.f32.s32	s15, s15
 472:Src/foc.c     **** 
 433              		.loc 1 472 9 is_stmt 1 view .LVU97
 434 00b4 20EE010A 		vmul.f32	s0, s0, s2
 435 00b8 60EE810A 		vmul.f32	s1, s1, s2
 436 00bc 27EE811A 		vmul.f32	s2, s15, s2
 437              	.LVL13:
 472:Src/foc.c     **** 
 438              		.loc 1 472 9 is_stmt 0 view .LVU98
 439 00c0 FFF7FEFF 		bl	SVPWM_Step
 440              	.LVL14:
 475:Src/foc.c     **** 
 441              		.loc 1 475 9 is_stmt 1 view .LVU99
 475:Src/foc.c     **** 
 442              		.loc 1 475 29 is_stmt 0 view .LVU100
 443 00c4 0123     		movs	r3, #1
 444 00c6 2360     		str	r3, [r4]
 477:Src/foc.c     ****     }
 445              		.loc 1 477 9 is_stmt 1 view .LVU101
 446 00c8 DAE7     		b	.L19
 447              	.LVL15:
 448              	.L27:
 488:Src/foc.c     ****         current1 = 0;
 449              		.loc 1 488 9 view .LVU102
 450 00ca 10EE100A 		vmov	r0, s0
 451 00ce FFF7FEFF 		bl	__aeabi_f2d
 452              	.LVL16:
 488:Src/foc.c     ****         current1 = 0;
 453              		.loc 1 488 9 is_stmt 0 view .LVU103
 454 00d2 0446     		mov	r4, r0
 455 00d4 0D46     		mov	r5, r1
 456 00d6 18EE900A 		vmov	r0, s17
 457 00da FFF7FEFF 		bl	__aeabi_f2d
 458              	.LVL17:
 459 00de CDE90201 		strd	r0, [sp, #8]
 460 00e2 18EE100A 		vmov	r0, s16
 461 00e6 FFF7FEFF 		bl	__aeabi_f2d
 462              	.LVL18:
 463 00ea CDE90001 		strd	r0, [sp]
 464 00ee 2246     		mov	r2, r4
 465 00f0 2B46     		mov	r3, r5
 466 00f2 2248     		ldr	r0, .L28+36
 467 00f4 FFF7FEFF 		bl	uprintf_polling
 468              	.LVL19:
 489:Src/foc.c     ****         current2 = 0;
 469              		.loc 1 489 9 is_stmt 1 view .LVU104
 489:Src/foc.c     ****         current2 = 0;
 470              		.loc 1 489 18 is_stmt 0 view .LVU105
 471 00f8 0023     		movs	r3, #0
 472 00fa 1D4A     		ldr	r2, .L28+24
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 20


 473 00fc 1360     		str	r3, [r2]	@ float
 490:Src/foc.c     ****         Board_Mode = STOP_MODE;
 474              		.loc 1 490 9 is_stmt 1 view .LVU106
 490:Src/foc.c     ****         Board_Mode = STOP_MODE;
 475              		.loc 1 490 18 is_stmt 0 view .LVU107
 476 00fe 1D4A     		ldr	r2, .L28+28
 477 0100 1360     		str	r3, [r2]	@ float
 491:Src/foc.c     ****         Measure_R_Info.time = 0;
 478              		.loc 1 491 9 is_stmt 1 view .LVU108
 491:Src/foc.c     ****         Measure_R_Info.time = 0;
 479              		.loc 1 491 20 is_stmt 0 view .LVU109
 480 0102 0022     		movs	r2, #0
 481 0104 1E4B     		ldr	r3, .L28+40
 482 0106 1A70     		strb	r2, [r3]
 492:Src/foc.c     **** 
 483              		.loc 1 492 9 is_stmt 1 view .LVU110
 492:Src/foc.c     **** 
 484              		.loc 1 492 29 is_stmt 0 view .LVU111
 485 0108 134B     		ldr	r3, .L28
 486 010a 1A60     		str	r2, [r3]
 494:Src/foc.c     ****         {
 487              		.loc 1 494 9 is_stmt 1 view .LVU112
 494:Src/foc.c     ****         {
 488              		.loc 1 494 27 is_stmt 0 view .LVU113
 489 010c 9C68     		ldr	r4, [r3, #8]
 494:Src/foc.c     ****         {
 490              		.loc 1 494 48 view .LVU114
 491 010e 1B69     		ldr	r3, [r3, #16]
 494:Src/foc.c     ****         {
 492              		.loc 1 494 12 view .LVU115
 493 0110 9C42     		cmp	r4, r3
 494 0112 09D2     		bcs	.L23
 496:Src/foc.c     ****         }
 495              		.loc 1 496 13 is_stmt 1 view .LVU116
 496 0114 2146     		mov	r1, r4
 497 0116 1B48     		ldr	r0, .L28+44
 498 0118 FFF7FEFF 		bl	uprintf_polling
 499              	.LVL20:
 500              	.L24:
 503:Src/foc.c     ****         Measure_R_Info.cnt = 0;
 501              		.loc 1 503 9 view .LVU117
 503:Src/foc.c     ****         Measure_R_Info.cnt = 0;
 502              		.loc 1 503 36 is_stmt 0 view .LVU118
 503 011c 0E4B     		ldr	r3, .L28
 504 011e 0022     		movs	r2, #0
 505 0120 5A61     		str	r2, [r3, #20]	@ float
 504:Src/foc.c     ****     }
 506              		.loc 1 504 9 is_stmt 1 view .LVU119
 504:Src/foc.c     ****     }
 507              		.loc 1 504 28 is_stmt 0 view .LVU120
 508 0122 0022     		movs	r2, #0
 509 0124 9A60     		str	r2, [r3, #8]
 510 0126 ABE7     		b	.L19
 511              	.LVL21:
 512              	.L23:
 500:Src/foc.c     ****             uprintf_polling("current_avg:%f cnt:%d \r\n", cur_avg, Measure_R_Info.cnt);
 513              		.loc 1 500 13 is_stmt 1 view .LVU121
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 21


 500:Src/foc.c     ****             uprintf_polling("current_avg:%f cnt:%d \r\n", cur_avg, Measure_R_Info.cnt);
 514              		.loc 1 500 37 is_stmt 0 view .LVU122
 515 0128 0B4A     		ldr	r2, .L28
 516 012a 92ED057A 		vldr.32	s14, [r2, #20]
 500:Src/foc.c     ****             uprintf_polling("current_avg:%f cnt:%d \r\n", cur_avg, Measure_R_Info.cnt);
 517              		.loc 1 500 92 view .LVU123
 518 012e D268     		ldr	r2, [r2, #12]
 500:Src/foc.c     ****             uprintf_polling("current_avg:%f cnt:%d \r\n", cur_avg, Measure_R_Info.cnt);
 519              		.loc 1 500 76 view .LVU124
 520 0130 9B1A     		subs	r3, r3, r2
 500:Src/foc.c     ****             uprintf_polling("current_avg:%f cnt:%d \r\n", cur_avg, Measure_R_Info.cnt);
 521              		.loc 1 500 105 view .LVU125
 522 0132 0133     		adds	r3, r3, #1
 500:Src/foc.c     ****             uprintf_polling("current_avg:%f cnt:%d \r\n", cur_avg, Measure_R_Info.cnt);
 523              		.loc 1 500 50 view .LVU126
 524 0134 07EE903A 		vmov	s15, r3	@ int
 525 0138 F8EE677A 		vcvt.f32.u32	s15, s15
 526              	.LVL22:
 501:Src/foc.c     ****         }
 527              		.loc 1 501 13 is_stmt 1 view .LVU127
 528 013c C7EE277A 		vdiv.f32	s15, s14, s15
 529              	.LVL23:
 501:Src/foc.c     ****         }
 530              		.loc 1 501 13 is_stmt 0 view .LVU128
 531 0140 17EE900A 		vmov	r0, s15
 532 0144 FFF7FEFF 		bl	__aeabi_f2d
 533              	.LVL24:
 501:Src/foc.c     ****         }
 534              		.loc 1 501 13 view .LVU129
 535 0148 0246     		mov	r2, r0
 536 014a 0B46     		mov	r3, r1
 537 014c 0094     		str	r4, [sp]
 538 014e 0E48     		ldr	r0, .L28+48
 539 0150 FFF7FEFF 		bl	uprintf_polling
 540              	.LVL25:
 541 0154 E2E7     		b	.L24
 542              	.L29:
 543 0156 00BF     		.align	2
 544              	.L28:
 545 0158 00000000 		.word	Measure_R_Info
 546 015c 00000000 		.word	ADC_Values_Raw2
 547 0160 00404E45 		.word	1162756096
 548 0164 00008039 		.word	964689920
 549 0168 00004843 		.word	1128792064
 550 016c A69B443B 		.word	994352038
 551 0170 00000000 		.word	.LANCHOR3
 552 0174 00000000 		.word	.LANCHOR4
 553 0178 00000000 		.word	.LANCHOR1
 554 017c 00000000 		.word	.LC0
 555 0180 00000000 		.word	Board_Mode
 556 0184 24000000 		.word	.LC1
 557 0188 44000000 		.word	.LC2
 558              		.cfi_endproc
 559              	.LFE184:
 561              		.section	.text.Foc_Init,"ax",%progbits
 562              		.align	1
 563              		.global	Foc_Init
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 22


 564              		.syntax unified
 565              		.thumb
 566              		.thumb_func
 567              		.fpu fpv4-sp-d16
 569              	Foc_Init:
 570              	.LVL26:
 571              	.LFB167:
  81:Src/foc.c     ****     // rps unit is r/s
 572              		.loc 1 81 1 is_stmt 1 view -0
 573              		.cfi_startproc
 574              		@ args = 0, pretend = 0, frame = 0
 575              		@ frame_needed = 0, uses_anonymous_args = 0
  81:Src/foc.c     ****     // rps unit is r/s
 576              		.loc 1 81 1 is_stmt 0 view .LVU131
 577 0000 10B5     		push	{r4, lr}
 578              	.LCFI11:
 579              		.cfi_def_cfa_offset 8
 580              		.cfi_offset 4, -8
 581              		.cfi_offset 14, -4
  83:Src/foc.c     ****     TIM8->ARR = 168000000 / TIM8_FREQ / 2;
 582              		.loc 1 83 5 is_stmt 1 view .LVU132
  83:Src/foc.c     ****     TIM8->ARR = 168000000 / TIM8_FREQ / 2;
 583              		.loc 1 83 16 is_stmt 0 view .LVU133
 584 0002 1A4B     		ldr	r3, .L32
 585 0004 F422     		movs	r2, #244
 586 0006 1A70     		strb	r2, [r3]
  84:Src/foc.c     **** 
 587              		.loc 1 84 5 is_stmt 1 view .LVU134
  84:Src/foc.c     **** 
 588              		.loc 1 84 15 is_stmt 0 view .LVU135
 589 0008 194B     		ldr	r3, .L32+4
 590 000a 41F26802 		movw	r2, #4200
 591 000e DA62     		str	r2, [r3, #44]
  86:Src/foc.c     **** 
 592              		.loc 1 86 5 is_stmt 1 view .LVU136
  86:Src/foc.c     **** 
 593              		.loc 1 86 22 is_stmt 0 view .LVU137
 594 0010 DA6A     		ldr	r2, [r3, #44]
  86:Src/foc.c     **** 
 595              		.loc 1 86 28 view .LVU138
 596 0012 023A     		subs	r2, r2, #2
  86:Src/foc.c     **** 
 597              		.loc 1 86 16 view .LVU139
 598 0014 1A64     		str	r2, [r3, #64]
  88:Src/foc.c     **** #ifdef DRIVE
 599              		.loc 1 88 5 is_stmt 1 view .LVU140
 600 0016 FFF7FEFF 		bl	UVects_Init
 601              	.LVL27:
  90:Src/foc.c     ****     HAL_TIM_PWM_Start(&htim8, TIM_CHANNEL_2);
 602              		.loc 1 90 5 view .LVU141
 603 001a 164C     		ldr	r4, .L32+8
 604 001c 0021     		movs	r1, #0
 605 001e 2046     		mov	r0, r4
 606 0020 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 607              	.LVL28:
  91:Src/foc.c     ****     HAL_TIM_PWM_Start(&htim8, TIM_CHANNEL_3);
 608              		.loc 1 91 5 view .LVU142
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 23


 609 0024 0421     		movs	r1, #4
 610 0026 2046     		mov	r0, r4
 611 0028 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 612              	.LVL29:
  92:Src/foc.c     **** 
 613              		.loc 1 92 5 view .LVU143
 614 002c 0821     		movs	r1, #8
 615 002e 2046     		mov	r0, r4
 616 0030 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 617              	.LVL30:
  94:Src/foc.c     ****     HAL_TIMEx_PWMN_Start(&htim8, TIM_CHANNEL_2);
 618              		.loc 1 94 5 view .LVU144
 619 0034 0021     		movs	r1, #0
 620 0036 2046     		mov	r0, r4
 621 0038 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 622              	.LVL31:
  95:Src/foc.c     ****     HAL_TIMEx_PWMN_Start(&htim8, TIM_CHANNEL_3);
 623              		.loc 1 95 5 view .LVU145
 624 003c 0421     		movs	r1, #4
 625 003e 2046     		mov	r0, r4
 626 0040 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 627              	.LVL32:
  96:Src/foc.c     **** #endif
 628              		.loc 1 96 5 view .LVU146
 629 0044 0821     		movs	r1, #8
 630 0046 2046     		mov	r0, r4
 631 0048 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 632              	.LVL33:
  98:Src/foc.c     ****     TIM7->ARR = 12000000 / 250 - 1;
 633              		.loc 1 98 5 view .LVU147
  98:Src/foc.c     ****     TIM7->ARR = 12000000 / 250 - 1;
 634              		.loc 1 98 15 is_stmt 0 view .LVU148
 635 004c 0A4B     		ldr	r3, .L32+12
 636 004e 0622     		movs	r2, #6
 637 0050 9A62     		str	r2, [r3, #40]
  99:Src/foc.c     **** 
 638              		.loc 1 99 5 is_stmt 1 view .LVU149
  99:Src/foc.c     **** 
 639              		.loc 1 99 15 is_stmt 0 view .LVU150
 640 0052 4BF67F32 		movw	r2, #47999
 641 0056 DA62     		str	r2, [r3, #44]
 104:Src/foc.c     ****     HAL_TIM_Base_Start_IT(&htim6);
 642              		.loc 1 104 5 is_stmt 1 view .LVU151
 643 0058 0848     		ldr	r0, .L32+16
 644 005a FFF7FEFF 		bl	HAL_TIM_Base_Start_IT
 645              	.LVL34:
 105:Src/foc.c     ****     HAL_TIM_Base_Start(&htim8);
 646              		.loc 1 105 5 view .LVU152
 647 005e 0848     		ldr	r0, .L32+20
 648 0060 FFF7FEFF 		bl	HAL_TIM_Base_Start_IT
 649              	.LVL35:
 106:Src/foc.c     **** }
 650              		.loc 1 106 5 view .LVU153
 651 0064 2046     		mov	r0, r4
 652 0066 FFF7FEFF 		bl	HAL_TIM_Base_Start
 653              	.LVL36:
 107:Src/foc.c     **** 
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 24


 654              		.loc 1 107 1 is_stmt 0 view .LVU154
 655 006a 10BD     		pop	{r4, pc}
 656              	.L33:
 657              		.align	2
 658              	.L32:
 659 006c 00000000 		.word	Board_Mode
 660 0070 00040140 		.word	1073808384
 661 0074 00000000 		.word	htim8
 662 0078 00140040 		.word	1073746944
 663 007c 00000000 		.word	htim7
 664 0080 00000000 		.word	htim6
 665              		.cfi_endproc
 666              	.LFE167:
 668              		.section	.text.get_area,"ax",%progbits
 669              		.align	1
 670              		.global	get_area
 671              		.syntax unified
 672              		.thumb
 673              		.thumb_func
 674              		.fpu fpv4-sp-d16
 676              	get_area:
 677              	.LVL37:
 678              	.LFB168:
 110:Src/foc.c     ****     return now_theta / 60 + 1;
 679              		.loc 1 110 1 is_stmt 1 view -0
 680              		.cfi_startproc
 681              		@ args = 0, pretend = 0, frame = 0
 682              		@ frame_needed = 0, uses_anonymous_args = 0
 683              		@ link register save eliminated.
 111:Src/foc.c     **** }
 684              		.loc 1 111 5 view .LVU156
 111:Src/foc.c     **** }
 685              		.loc 1 111 22 is_stmt 0 view .LVU157
 686 0000 034B     		ldr	r3, .L35
 687 0002 A3FB0030 		umull	r3, r0, r3, r0
 688              	.LVL38:
 111:Src/foc.c     **** }
 689              		.loc 1 111 22 view .LVU158
 690 0006 4009     		lsrs	r0, r0, #5
 111:Src/foc.c     **** }
 691              		.loc 1 111 27 view .LVU159
 692 0008 0130     		adds	r0, r0, #1
 112:Src/foc.c     **** 
 693              		.loc 1 112 1 view .LVU160
 694 000a C0B2     		uxtb	r0, r0
 695 000c 7047     		bx	lr
 696              	.L36:
 697 000e 00BF     		.align	2
 698              	.L35:
 699 0010 89888888 		.word	-2004318071
 700              		.cfi_endproc
 701              	.LFE168:
 703              		.section	.text.get_area_u,"ax",%progbits
 704              		.align	1
 705              		.global	get_area_u
 706              		.syntax unified
 707              		.thumb
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 25


 708              		.thumb_func
 709              		.fpu fpv4-sp-d16
 711              	get_area_u:
 712              	.LVL39:
 713              	.LFB169:
 117:Src/foc.c     ****     switch (area)
 714              		.loc 1 117 1 is_stmt 1 view -0
 715              		.cfi_startproc
 716              		@ args = 0, pretend = 0, frame = 0
 717              		@ frame_needed = 0, uses_anonymous_args = 0
 718              		@ link register save eliminated.
 117:Src/foc.c     ****     switch (area)
 719              		.loc 1 117 1 is_stmt 0 view .LVU162
 720 0000 30B4     		push	{r4, r5}
 721              	.LCFI12:
 722              		.cfi_def_cfa_offset 8
 723              		.cfi_offset 4, -8
 724              		.cfi_offset 5, -4
 725 0002 0D46     		mov	r5, r1
 726 0004 1446     		mov	r4, r2
 118:Src/foc.c     ****     {
 727              		.loc 1 118 5 is_stmt 1 view .LVU163
 728 0006 0138     		subs	r0, r0, #1
 729              	.LVL40:
 118:Src/foc.c     ****     {
 730              		.loc 1 118 5 is_stmt 0 view .LVU164
 731 0008 0528     		cmp	r0, #5
 732 000a 0CD8     		bhi	.L37
 733 000c DFE800F0 		tbb	[pc, r0]
 734              	.L40:
 735 0010 03       		.byte	(.L45-.L40)/2
 736 0011 0D       		.byte	(.L44-.L40)/2
 737 0012 16       		.byte	(.L43-.L40)/2
 738 0013 1F       		.byte	(.L42-.L40)/2
 739 0014 28       		.byte	(.L41-.L40)/2
 740 0015 31       		.byte	(.L39-.L40)/2
 741              		.p2align 1
 742              	.L45:
 121:Src/foc.c     ****         *u2 = U6;
 743              		.loc 1 121 9 is_stmt 1 view .LVU165
 121:Src/foc.c     ****         *u2 = U6;
 744              		.loc 1 121 13 is_stmt 0 view .LVU166
 745 0016 1B4B     		ldr	r3, .L47
 746 0018 0FCB     		ldm	r3, {r0, r1, r2, r3}
 747              	.LVL41:
 121:Src/foc.c     ****         *u2 = U6;
 748              		.loc 1 121 13 view .LVU167
 749 001a 85E80F00 		stm	r5, {r0, r1, r2, r3}
 122:Src/foc.c     ****         break;
 750              		.loc 1 122 9 is_stmt 1 view .LVU168
 122:Src/foc.c     ****         break;
 751              		.loc 1 122 13 is_stmt 0 view .LVU169
 752 001e 1A4B     		ldr	r3, .L47+4
 753 0020 0FCB     		ldm	r3, {r0, r1, r2, r3}
 754 0022 84E80F00 		stm	r4, {r0, r1, r2, r3}
 123:Src/foc.c     ****     case 2:
 755              		.loc 1 123 9 is_stmt 1 view .LVU170
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 26


 756              	.L37:
 147:Src/foc.c     **** 
 757              		.loc 1 147 1 is_stmt 0 view .LVU171
 758 0026 30BC     		pop	{r4, r5}
 759              	.LCFI13:
 760              		.cfi_remember_state
 761              		.cfi_restore 5
 762              		.cfi_restore 4
 763              		.cfi_def_cfa_offset 0
 764              	.LVL42:
 147:Src/foc.c     **** 
 765              		.loc 1 147 1 view .LVU172
 766 0028 7047     		bx	lr
 767              	.LVL43:
 768              	.L44:
 769              	.LCFI14:
 770              		.cfi_restore_state
 125:Src/foc.c     ****         *u2 = U2;
 771              		.loc 1 125 9 is_stmt 1 view .LVU173
 125:Src/foc.c     ****         *u2 = U2;
 772              		.loc 1 125 13 is_stmt 0 view .LVU174
 773 002a 174B     		ldr	r3, .L47+4
 774 002c 0FCB     		ldm	r3, {r0, r1, r2, r3}
 775              	.LVL44:
 125:Src/foc.c     ****         *u2 = U2;
 776              		.loc 1 125 13 view .LVU175
 777 002e 85E80F00 		stm	r5, {r0, r1, r2, r3}
 126:Src/foc.c     ****         break;
 778              		.loc 1 126 9 is_stmt 1 view .LVU176
 126:Src/foc.c     ****         break;
 779              		.loc 1 126 13 is_stmt 0 view .LVU177
 780 0032 164B     		ldr	r3, .L47+8
 781 0034 0FCB     		ldm	r3, {r0, r1, r2, r3}
 782 0036 84E80F00 		stm	r4, {r0, r1, r2, r3}
 127:Src/foc.c     ****     case 3:
 783              		.loc 1 127 9 is_stmt 1 view .LVU178
 784 003a F4E7     		b	.L37
 785              	.LVL45:
 786              	.L43:
 129:Src/foc.c     ****         *u2 = U3;
 787              		.loc 1 129 9 view .LVU179
 129:Src/foc.c     ****         *u2 = U3;
 788              		.loc 1 129 13 is_stmt 0 view .LVU180
 789 003c 134B     		ldr	r3, .L47+8
 790 003e 0FCB     		ldm	r3, {r0, r1, r2, r3}
 791              	.LVL46:
 129:Src/foc.c     ****         *u2 = U3;
 792              		.loc 1 129 13 view .LVU181
 793 0040 85E80F00 		stm	r5, {r0, r1, r2, r3}
 130:Src/foc.c     ****         break;
 794              		.loc 1 130 9 is_stmt 1 view .LVU182
 130:Src/foc.c     ****         break;
 795              		.loc 1 130 13 is_stmt 0 view .LVU183
 796 0044 124B     		ldr	r3, .L47+12
 797 0046 0FCB     		ldm	r3, {r0, r1, r2, r3}
 798 0048 84E80F00 		stm	r4, {r0, r1, r2, r3}
 131:Src/foc.c     ****     case 4:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 27


 799              		.loc 1 131 9 is_stmt 1 view .LVU184
 800 004c EBE7     		b	.L37
 801              	.LVL47:
 802              	.L42:
 133:Src/foc.c     ****         *u2 = U1;
 803              		.loc 1 133 9 view .LVU185
 133:Src/foc.c     ****         *u2 = U1;
 804              		.loc 1 133 13 is_stmt 0 view .LVU186
 805 004e 104B     		ldr	r3, .L47+12
 806 0050 0FCB     		ldm	r3, {r0, r1, r2, r3}
 807              	.LVL48:
 133:Src/foc.c     ****         *u2 = U1;
 808              		.loc 1 133 13 view .LVU187
 809 0052 85E80F00 		stm	r5, {r0, r1, r2, r3}
 134:Src/foc.c     ****         break;
 810              		.loc 1 134 9 is_stmt 1 view .LVU188
 134:Src/foc.c     ****         break;
 811              		.loc 1 134 13 is_stmt 0 view .LVU189
 812 0056 0F4B     		ldr	r3, .L47+16
 813 0058 0FCB     		ldm	r3, {r0, r1, r2, r3}
 814 005a 84E80F00 		stm	r4, {r0, r1, r2, r3}
 135:Src/foc.c     ****     case 5:
 815              		.loc 1 135 9 is_stmt 1 view .LVU190
 816 005e E2E7     		b	.L37
 817              	.LVL49:
 818              	.L41:
 137:Src/foc.c     ****         *u2 = U5;
 819              		.loc 1 137 9 view .LVU191
 137:Src/foc.c     ****         *u2 = U5;
 820              		.loc 1 137 13 is_stmt 0 view .LVU192
 821 0060 0C4B     		ldr	r3, .L47+16
 822 0062 0FCB     		ldm	r3, {r0, r1, r2, r3}
 823              	.LVL50:
 137:Src/foc.c     ****         *u2 = U5;
 824              		.loc 1 137 13 view .LVU193
 825 0064 85E80F00 		stm	r5, {r0, r1, r2, r3}
 138:Src/foc.c     ****         break;
 826              		.loc 1 138 9 is_stmt 1 view .LVU194
 138:Src/foc.c     ****         break;
 827              		.loc 1 138 13 is_stmt 0 view .LVU195
 828 0068 0B4B     		ldr	r3, .L47+20
 829 006a 0FCB     		ldm	r3, {r0, r1, r2, r3}
 830 006c 84E80F00 		stm	r4, {r0, r1, r2, r3}
 139:Src/foc.c     ****     case 6:
 831              		.loc 1 139 9 is_stmt 1 view .LVU196
 832 0070 D9E7     		b	.L37
 833              	.LVL51:
 834              	.L39:
 141:Src/foc.c     ****         *u2 = U4;
 835              		.loc 1 141 9 view .LVU197
 141:Src/foc.c     ****         *u2 = U4;
 836              		.loc 1 141 13 is_stmt 0 view .LVU198
 837 0072 094B     		ldr	r3, .L47+20
 838 0074 0FCB     		ldm	r3, {r0, r1, r2, r3}
 839              	.LVL52:
 141:Src/foc.c     ****         *u2 = U4;
 840              		.loc 1 141 13 view .LVU199
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 28


 841 0076 85E80F00 		stm	r5, {r0, r1, r2, r3}
 142:Src/foc.c     ****         break;
 842              		.loc 1 142 9 is_stmt 1 view .LVU200
 142:Src/foc.c     ****         break;
 843              		.loc 1 142 13 is_stmt 0 view .LVU201
 844 007a 024B     		ldr	r3, .L47
 845 007c 0FCB     		ldm	r3, {r0, r1, r2, r3}
 846 007e 84E80F00 		stm	r4, {r0, r1, r2, r3}
 143:Src/foc.c     ****     default:
 847              		.loc 1 143 9 is_stmt 1 view .LVU202
 147:Src/foc.c     **** 
 848              		.loc 1 147 1 is_stmt 0 view .LVU203
 849 0082 D0E7     		b	.L37
 850              	.L48:
 851              		.align	2
 852              	.L47:
 853 0084 00000000 		.word	.LANCHOR5
 854 0088 00000000 		.word	.LANCHOR6
 855 008c 00000000 		.word	.LANCHOR7
 856 0090 00000000 		.word	.LANCHOR0
 857 0094 00000000 		.word	.LANCHOR8
 858 0098 00000000 		.word	.LANCHOR1
 859              		.cfi_endproc
 860              	.LFE169:
 862              		.section	.text.get_t,"ax",%progbits
 863              		.align	1
 864              		.global	get_t
 865              		.syntax unified
 866              		.thumb
 867              		.thumb_func
 868              		.fpu fpv4-sp-d16
 870              	get_t:
 871              	.LVL53:
 872              	.LFB170:
 154:Src/foc.c     ****     /*
 873              		.loc 1 154 1 is_stmt 1 view -0
 874              		.cfi_startproc
 875              		@ args = 0, pretend = 0, frame = 40
 876              		@ frame_needed = 0, uses_anonymous_args = 0
 154:Src/foc.c     ****     /*
 877              		.loc 1 154 1 is_stmt 0 view .LVU205
 878 0000 30B5     		push	{r4, r5, lr}
 879              	.LCFI15:
 880              		.cfi_def_cfa_offset 12
 881              		.cfi_offset 4, -12
 882              		.cfi_offset 5, -8
 883              		.cfi_offset 14, -4
 884 0002 2DED028B 		vpush.64	{d8}
 885              	.LCFI16:
 886              		.cfi_def_cfa_offset 20
 887              		.cfi_offset 80, -20
 888              		.cfi_offset 81, -16
 889 0006 8BB0     		sub	sp, sp, #44
 890              	.LCFI17:
 891              		.cfi_def_cfa_offset 64
 892 0008 B0EE408A 		vmov.f32	s16, s0
 893 000c 0546     		mov	r5, r0
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 29


 894 000e 0C46     		mov	r4, r1
 164:Src/foc.c     ****     float theta_f; // Âçï‰Ωç‰∏∫rad
 895              		.loc 1 164 5 is_stmt 1 view .LVU206
 165:Src/foc.c     ****     Uvect_Mos u1, u2;
 896              		.loc 1 165 5 view .LVU207
 166:Src/foc.c     ****     float x, y;
 897              		.loc 1 166 5 view .LVU208
 167:Src/foc.c     ****     get_area_u(get_area(theta), &u1, &u2);
 898              		.loc 1 167 5 view .LVU209
 168:Src/foc.c     ****     //theta_f=(float)theta*2.0f*PI/360;
 899              		.loc 1 168 5 view .LVU210
 900 0010 FCEEC07A 		vcvt.u32.f32	s15, s0
 901 0014 17EE900A 		vmov	r0, s15	@ int
 902              	.LVL54:
 168:Src/foc.c     ****     //theta_f=(float)theta*2.0f*PI/360;
 903              		.loc 1 168 5 is_stmt 0 view .LVU211
 904 0018 FFF7FEFF 		bl	get_area
 905              	.LVL55:
 168:Src/foc.c     ****     //theta_f=(float)theta*2.0f*PI/360;
 906              		.loc 1 168 5 view .LVU212
 907 001c 02AA     		add	r2, sp, #8
 908 001e 06A9     		add	r1, sp, #24
 909 0020 FFF7FEFF 		bl	get_area_u
 910              	.LVL56:
 170:Src/foc.c     ****     x *= 0.86f;
 911              		.loc 1 170 5 is_stmt 1 view .LVU213
 912 0024 01A9     		add	r1, sp, #4
 913 0026 6846     		mov	r0, sp
 914 0028 B0EE480A 		vmov.f32	s0, s16
 915 002c FFF7FEFF 		bl	arm_sin_cos_f32
 916              	.LVL57:
 171:Src/foc.c     ****     y *= 0.86f; // sqrt(3)/2 Ê≤°Èîô
 917              		.loc 1 171 5 view .LVU214
 171:Src/foc.c     ****     y *= 0.86f; // sqrt(3)/2 Ê≤°Èîô
 918              		.loc 1 171 7 is_stmt 0 view .LVU215
 919 0030 DFED197A 		vldr.32	s15, .L51
 920 0034 9DED017A 		vldr.32	s14, [sp, #4]
 921 0038 27EE277A 		vmul.f32	s14, s14, s15
 172:Src/foc.c     ****     //x=0.86f*cosf(theta_f);
 922              		.loc 1 172 5 is_stmt 1 view .LVU216
 172:Src/foc.c     ****     //x=0.86f*cosf(theta_f);
 923              		.loc 1 172 7 is_stmt 0 view .LVU217
 924 003c DDED006A 		vldr.32	s13, [sp]
 925 0040 66EEA76A 		vmul.f32	s13, s13, s15
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 926              		.loc 1 175 5 is_stmt 1 view .LVU218
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 927              		.loc 1 175 17 is_stmt 0 view .LVU219
 928 0044 DDED057A 		vldr.32	s15, [sp, #20]
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 929              		.loc 1 175 20 view .LVU220
 930 0048 27EE274A 		vmul.f32	s8, s14, s15
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 931              		.loc 1 175 29 view .LVU221
 932 004c DDED084A 		vldr.32	s9, [sp, #32]
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 933              		.loc 1 175 32 view .LVU222
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 30


 934 0050 67EEA47A 		vmul.f32	s15, s15, s9
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 935              		.loc 1 175 43 view .LVU223
 936 0054 9DED046A 		vldr.32	s12, [sp, #16]
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 937              		.loc 1 175 50 view .LVU224
 938 0058 9DED095A 		vldr.32	s10, [sp, #36]
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 939              		.loc 1 175 46 view .LVU225
 940 005c 66EE055A 		vmul.f32	s11, s12, s10
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 941              		.loc 1 175 39 view .LVU226
 942 0060 77EEE57A 		vsub.f32	s15, s15, s11
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 943              		.loc 1 175 24 view .LVU227
 944 0064 C4EE275A 		vdiv.f32	s11, s8, s15
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 945              		.loc 1 175 62 view .LVU228
 946 0068 26EE866A 		vmul.f32	s12, s13, s12
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 947              		.loc 1 175 67 view .LVU229
 948 006c 86EE274A 		vdiv.f32	s8, s12, s15
 175:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 949              		.loc 1 175 13 view .LVU230
 950 0070 75EEC45A 		vsub.f32	s11, s11, s8
 951              	.LVL58:
 176:Src/foc.c     **** 
 952              		.loc 1 176 5 is_stmt 1 view .LVU231
 176:Src/foc.c     **** 
 953              		.loc 1 176 20 is_stmt 0 view .LVU232
 954 0074 66EEA46A 		vmul.f32	s13, s13, s9
 176:Src/foc.c     **** 
 955              		.loc 1 176 24 view .LVU233
 956 0078 86EEA76A 		vdiv.f32	s12, s13, s15
 176:Src/foc.c     **** 
 957              		.loc 1 176 62 view .LVU234
 958 007c 27EE057A 		vmul.f32	s14, s14, s10
 176:Src/foc.c     **** 
 959              		.loc 1 176 67 view .LVU235
 960 0080 C7EE276A 		vdiv.f32	s13, s14, s15
 176:Src/foc.c     **** 
 961              		.loc 1 176 13 view .LVU236
 962 0084 76EE667A 		vsub.f32	s15, s12, s13
 963              	.LVL59:
 178:Src/foc.c     ****     *t2 = temp_t2;
 964              		.loc 1 178 5 is_stmt 1 view .LVU237
 178:Src/foc.c     ****     *t2 = temp_t2;
 965              		.loc 1 178 9 is_stmt 0 view .LVU238
 966 0088 C5ED005A 		vstr.32	s11, [r5]
 179:Src/foc.c     **** }
 967              		.loc 1 179 5 is_stmt 1 view .LVU239
 179:Src/foc.c     **** }
 968              		.loc 1 179 9 is_stmt 0 view .LVU240
 969 008c C4ED007A 		vstr.32	s15, [r4]
 180:Src/foc.c     **** 
 970              		.loc 1 180 1 view .LVU241
 971 0090 0BB0     		add	sp, sp, #44
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 31


 972              	.LCFI18:
 973              		.cfi_def_cfa_offset 20
 974              		@ sp needed
 975 0092 BDEC028B 		vldm	sp!, {d8}
 976              	.LCFI19:
 977              		.cfi_restore 80
 978              		.cfi_restore 81
 979              		.cfi_def_cfa_offset 12
 980              	.LVL60:
 180:Src/foc.c     **** 
 981              		.loc 1 180 1 view .LVU242
 982 0096 30BD     		pop	{r4, r5, pc}
 983              	.LVL61:
 984              	.L52:
 180:Src/foc.c     **** 
 985              		.loc 1 180 1 view .LVU243
 986              		.align	2
 987              	.L51:
 988 0098 F6285C3F 		.word	1063004406
 989              		.cfi_endproc
 990              	.LFE170:
 992              		.section	.text.get_ccr_duty,"ax",%progbits
 993              		.align	1
 994              		.global	get_ccr_duty
 995              		.syntax unified
 996              		.thumb
 997              		.thumb_func
 998              		.fpu fpv4-sp-d16
 1000              	get_ccr_duty:
 1001              	.LVL62:
 1002              	.LFB171:
 183:Src/foc.c     ****     float t0, t3;
 1003              		.loc 1 183 1 is_stmt 1 view -0
 1004              		.cfi_startproc
 1005              		@ args = 16, pretend = 0, frame = 56
 1006              		@ frame_needed = 0, uses_anonymous_args = 0
 1007              		@ link register save eliminated.
 183:Src/foc.c     ****     float t0, t3;
 1008              		.loc 1 183 1 is_stmt 0 view .LVU245
 1009 0000 10B4     		push	{r4}
 1010              	.LCFI20:
 1011              		.cfi_def_cfa_offset 4
 1012              		.cfi_offset 4, -4
 1013 0002 8FB0     		sub	sp, sp, #60
 1014              	.LCFI21:
 1015              		.cfi_def_cfa_offset 64
 1016 0004 04AC     		add	r4, sp, #16
 1017 0006 84E80F00 		stm	r4, {r0, r1, r2, r3}
 184:Src/foc.c     ****     CCR_Duty result;
 1018              		.loc 1 184 5 is_stmt 1 view .LVU246
 185:Src/foc.c     ****     t0 = (1 - t1 - t2) / 2;
 1019              		.loc 1 185 5 view .LVU247
 186:Src/foc.c     ****     t3 = t0;
 1020              		.loc 1 186 5 view .LVU248
 186:Src/foc.c     ****     t3 = t0;
 1021              		.loc 1 186 13 is_stmt 0 view .LVU249
 1022 000a F7EE007A 		vmov.f32	s15, #1.0e+0
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 32


 1023 000e 77EEC07A 		vsub.f32	s15, s15, s0
 186:Src/foc.c     ****     t3 = t0;
 1024              		.loc 1 186 18 view .LVU250
 1025 0012 77EEE07A 		vsub.f32	s15, s15, s1
 186:Src/foc.c     ****     t3 = t0;
 1026              		.loc 1 186 8 view .LVU251
 1027 0016 B6EE007A 		vmov.f32	s14, #5.0e-1
 1028 001a 27EE877A 		vmul.f32	s14, s15, s14
 1029              	.LVL63:
 187:Src/foc.c     **** 
 1030              		.loc 1 187 5 is_stmt 1 view .LVU252
 189:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 1031              		.loc 1 189 5 view .LVU253
 189:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 1032              		.loc 1 189 21 is_stmt 0 view .LVU254
 1033 001e 344B     		ldr	r3, .L55
 1034 0020 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1035 0022 07EE902A 		vmov	s15, r2	@ int
 189:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 1036              		.loc 1 189 24 view .LVU255
 1037 0026 F8EEE77A 		vcvt.f32.s32	s15, s15
 1038 002a 67EE877A 		vmul.f32	s15, s15, s14
 189:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 1039              		.loc 1 189 33 view .LVU256
 1040 002e 9DF81020 		ldrb	r2, [sp, #16]	@ zero_extendqisi2
 1041 0032 06EE902A 		vmov	s13, r2	@ int
 189:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 1042              		.loc 1 189 36 view .LVU257
 1043 0036 F8EEE66A 		vcvt.f32.s32	s13, s13
 1044 003a 66EE806A 		vmul.f32	s13, s13, s0
 189:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 1045              		.loc 1 189 29 view .LVU258
 1046 003e 77EEA67A 		vadd.f32	s15, s15, s13
 189:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 1047              		.loc 1 189 45 view .LVU259
 1048 0042 9DF84020 		ldrb	r2, [sp, #64]	@ zero_extendqisi2
 1049 0046 06EE902A 		vmov	s13, r2	@ int
 189:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 1050              		.loc 1 189 48 view .LVU260
 1051 004a F8EEE66A 		vcvt.f32.s32	s13, s13
 1052 004e 66EEA06A 		vmul.f32	s13, s13, s1
 189:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 1053              		.loc 1 189 41 view .LVU261
 1054 0052 77EEA67A 		vadd.f32	s15, s15, s13
 189:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 1055              		.loc 1 189 17 view .LVU262
 1056 0056 CDED087A 		vstr.32	s15, [sp, #32]
 190:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 1057              		.loc 1 190 5 is_stmt 1 view .LVU263
 190:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 1058              		.loc 1 190 21 is_stmt 0 view .LVU264
 1059 005a 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 1060 005c 07EE902A 		vmov	s15, r2	@ int
 190:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 1061              		.loc 1 190 24 view .LVU265
 1062 0060 F8EEE77A 		vcvt.f32.s32	s15, s15
 1063 0064 67EE877A 		vmul.f32	s15, s15, s14
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 33


 190:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 1064              		.loc 1 190 33 view .LVU266
 1065 0068 9DF81120 		ldrb	r2, [sp, #17]	@ zero_extendqisi2
 1066 006c 06EE902A 		vmov	s13, r2	@ int
 190:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 1067              		.loc 1 190 36 view .LVU267
 1068 0070 F8EEE66A 		vcvt.f32.s32	s13, s13
 1069 0074 66EE806A 		vmul.f32	s13, s13, s0
 190:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 1070              		.loc 1 190 29 view .LVU268
 1071 0078 77EEA67A 		vadd.f32	s15, s15, s13
 190:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 1072              		.loc 1 190 45 view .LVU269
 1073 007c 9DF84120 		ldrb	r2, [sp, #65]	@ zero_extendqisi2
 1074 0080 06EE902A 		vmov	s13, r2	@ int
 190:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 1075              		.loc 1 190 48 view .LVU270
 1076 0084 F8EEE66A 		vcvt.f32.s32	s13, s13
 1077 0088 66EEA06A 		vmul.f32	s13, s13, s1
 190:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 1078              		.loc 1 190 41 view .LVU271
 1079 008c 77EEA67A 		vadd.f32	s15, s15, s13
 190:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 1080              		.loc 1 190 17 view .LVU272
 1081 0090 CDED097A 		vstr.32	s15, [sp, #36]
 191:Src/foc.c     **** 
 1082              		.loc 1 191 5 is_stmt 1 view .LVU273
 191:Src/foc.c     **** 
 1083              		.loc 1 191 21 is_stmt 0 view .LVU274
 1084 0094 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 1085 0096 07EE903A 		vmov	s15, r3	@ int
 191:Src/foc.c     **** 
 1086              		.loc 1 191 24 view .LVU275
 1087 009a F8EEE77A 		vcvt.f32.s32	s15, s15
 1088 009e 67EE877A 		vmul.f32	s15, s15, s14
 191:Src/foc.c     **** 
 1089              		.loc 1 191 33 view .LVU276
 1090 00a2 9DF81230 		ldrb	r3, [sp, #18]	@ zero_extendqisi2
 1091 00a6 07EE103A 		vmov	s14, r3	@ int
 1092              	.LVL64:
 191:Src/foc.c     **** 
 1093              		.loc 1 191 36 view .LVU277
 1094 00aa B8EEC77A 		vcvt.f32.s32	s14, s14
 1095 00ae 27EE000A 		vmul.f32	s0, s14, s0
 1096              	.LVL65:
 191:Src/foc.c     **** 
 1097              		.loc 1 191 29 view .LVU278
 1098 00b2 37EE800A 		vadd.f32	s0, s15, s0
 191:Src/foc.c     **** 
 1099              		.loc 1 191 45 view .LVU279
 1100 00b6 9DF84230 		ldrb	r3, [sp, #66]	@ zero_extendqisi2
 1101 00ba 07EE903A 		vmov	s15, r3	@ int
 191:Src/foc.c     **** 
 1102              		.loc 1 191 48 view .LVU280
 1103 00be F8EEE77A 		vcvt.f32.s32	s15, s15
 1104 00c2 67EEA00A 		vmul.f32	s1, s15, s1
 1105              	.LVL66:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 34


 191:Src/foc.c     **** 
 1106              		.loc 1 191 41 view .LVU281
 1107 00c6 70EE200A 		vadd.f32	s1, s0, s1
 191:Src/foc.c     **** 
 1108              		.loc 1 191 17 view .LVU282
 1109 00ca CDED0A0A 		vstr.32	s1, [sp, #40]
 193:Src/foc.c     **** }
 1110              		.loc 1 193 5 is_stmt 1 view .LVU283
 193:Src/foc.c     **** }
 1111              		.loc 1 193 12 is_stmt 0 view .LVU284
 1112 00ce 08AB     		add	r3, sp, #32
 1113 00d0 93E80700 		ldm	r3, {r0, r1, r2}
 1114 00d4 0EAB     		add	r3, sp, #56
 1115 00d6 03E90700 		stmdb	r3, {r0, r1, r2}
 194:Src/foc.c     **** 
 1116              		.loc 1 194 1 view .LVU285
 1117 00da 9DED0B0A 		vldr.32	s0, [sp, #44]
 1118 00de DDED0C0A 		vldr.32	s1, [sp, #48]
 1119 00e2 9DED0D1A 		vldr.32	s2, [sp, #52]
 1120 00e6 0FB0     		add	sp, sp, #60
 1121              	.LCFI22:
 1122              		.cfi_def_cfa_offset 4
 1123              		@ sp needed
 1124 00e8 5DF8044B 		ldr	r4, [sp], #4
 1125              	.LCFI23:
 1126              		.cfi_restore 4
 1127              		.cfi_def_cfa_offset 0
 1128 00ec 7047     		bx	lr
 1129              	.L56:
 1130 00ee 00BF     		.align	2
 1131              	.L55:
 1132 00f0 00000000 		.word	.LANCHOR9
 1133              		.cfi_endproc
 1134              	.LFE171:
 1136              		.section	.rodata.Set_to_U4.str1.4,"aMS",%progbits,1
 1137              		.align	2
 1138              	.LC3:
 1139 0000 706F7369 		.ascii	"position:%f \015\012\000"
 1139      74696F6E 
 1139      3A256620 
 1139      0D0A00
 1140              		.section	.text.Set_to_U4,"ax",%progbits
 1141              		.align	1
 1142              		.global	Set_to_U4
 1143              		.syntax unified
 1144              		.thumb
 1145              		.thumb_func
 1146              		.fpu fpv4-sp-d16
 1148              	Set_to_U4:
 1149              	.LVL67:
 1150              	.LFB173:
 207:Src/foc.c     ****     CCR_Duty temp_duty = {0};
 1151              		.loc 1 207 1 is_stmt 1 view -0
 1152              		.cfi_startproc
 1153              		@ args = 0, pretend = 0, frame = 16
 1154              		@ frame_needed = 0, uses_anonymous_args = 0
 207:Src/foc.c     ****     CCR_Duty temp_duty = {0};
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 35


 1155              		.loc 1 207 1 is_stmt 0 view .LVU287
 1156 0000 10B5     		push	{r4, lr}
 1157              	.LCFI24:
 1158              		.cfi_def_cfa_offset 8
 1159              		.cfi_offset 4, -8
 1160              		.cfi_offset 14, -4
 1161 0002 84B0     		sub	sp, sp, #16
 1162              	.LCFI25:
 1163              		.cfi_def_cfa_offset 24
 1164 0004 0446     		mov	r4, r0
 208:Src/foc.c     ****     temp_duty.ccra = U4.a;
 1165              		.loc 1 208 5 is_stmt 1 view .LVU288
 209:Src/foc.c     ****     temp_duty.ccrb = U4.b;
 1166              		.loc 1 209 5 view .LVU289
 209:Src/foc.c     ****     temp_duty.ccrb = U4.b;
 1167              		.loc 1 209 24 is_stmt 0 view .LVU290
 1168 0006 194B     		ldr	r3, .L59
 1169 0008 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1170 000a 00EE102A 		vmov	s0, r2	@ int
 210:Src/foc.c     ****     temp_duty.ccrc = U4.c;
 1171              		.loc 1 210 5 is_stmt 1 view .LVU291
 210:Src/foc.c     ****     temp_duty.ccrc = U4.c;
 1172              		.loc 1 210 24 is_stmt 0 view .LVU292
 1173 000e 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 1174 0010 00EE902A 		vmov	s1, r2	@ int
 211:Src/foc.c     ****     SVPWM_Step(temp_duty);
 1175              		.loc 1 211 5 is_stmt 1 view .LVU293
 211:Src/foc.c     ****     SVPWM_Step(temp_duty);
 1176              		.loc 1 211 24 is_stmt 0 view .LVU294
 1177 0014 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 1178 0016 01EE103A 		vmov	s2, r3	@ int
 212:Src/foc.c     ****     HAL_Delay(t);
 1179              		.loc 1 212 5 is_stmt 1 view .LVU295
 1180 001a B8EE400A 		vcvt.f32.u32	s0, s0
 1181 001e F8EE600A 		vcvt.f32.u32	s1, s1
 1182 0022 B8EE411A 		vcvt.f32.u32	s2, s2
 1183 0026 FFF7FEFF 		bl	SVPWM_Step
 1184              	.LVL68:
 213:Src/foc.c     ****     temp_duty.ccra = U0.a;
 1185              		.loc 1 213 5 view .LVU296
 1186 002a 2046     		mov	r0, r4
 1187 002c FFF7FEFF 		bl	HAL_Delay
 1188              	.LVL69:
 214:Src/foc.c     ****     temp_duty.ccrb = U0.b;
 1189              		.loc 1 214 5 view .LVU297
 214:Src/foc.c     ****     temp_duty.ccrb = U0.b;
 1190              		.loc 1 214 24 is_stmt 0 view .LVU298
 1191 0030 0F4B     		ldr	r3, .L59+4
 1192 0032 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1193 0034 00EE102A 		vmov	s0, r2	@ int
 215:Src/foc.c     ****     temp_duty.ccrc = U0.c;
 1194              		.loc 1 215 5 is_stmt 1 view .LVU299
 215:Src/foc.c     ****     temp_duty.ccrc = U0.c;
 1195              		.loc 1 215 24 is_stmt 0 view .LVU300
 1196 0038 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 1197 003a 00EE902A 		vmov	s1, r2	@ int
 216:Src/foc.c     ****     SVPWM_Step(temp_duty);
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 36


 1198              		.loc 1 216 5 is_stmt 1 view .LVU301
 216:Src/foc.c     ****     SVPWM_Step(temp_duty);
 1199              		.loc 1 216 24 is_stmt 0 view .LVU302
 1200 003e 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 1201 0040 01EE103A 		vmov	s2, r3	@ int
 217:Src/foc.c     ****     uprintf("position:%f \r\n", Position_Degree);
 1202              		.loc 1 217 5 is_stmt 1 view .LVU303
 1203 0044 B8EE400A 		vcvt.f32.u32	s0, s0
 1204 0048 F8EE600A 		vcvt.f32.u32	s1, s1
 1205 004c B8EE411A 		vcvt.f32.u32	s2, s2
 1206 0050 FFF7FEFF 		bl	SVPWM_Step
 1207              	.LVL70:
 218:Src/foc.c     **** }
 1208              		.loc 1 218 5 view .LVU304
 1209 0054 074B     		ldr	r3, .L59+8
 1210 0056 1868     		ldr	r0, [r3]	@ float
 1211 0058 FFF7FEFF 		bl	__aeabi_f2d
 1212              	.LVL71:
 1213 005c 0246     		mov	r2, r0
 1214 005e 0B46     		mov	r3, r1
 1215 0060 0548     		ldr	r0, .L59+12
 1216 0062 FFF7FEFF 		bl	uprintf
 1217              	.LVL72:
 219:Src/foc.c     **** 
 1218              		.loc 1 219 1 is_stmt 0 view .LVU305
 1219 0066 04B0     		add	sp, sp, #16
 1220              	.LCFI26:
 1221              		.cfi_def_cfa_offset 8
 1222              		@ sp needed
 1223 0068 10BD     		pop	{r4, pc}
 1224              	.L60:
 1225 006a 00BF     		.align	2
 1226              	.L59:
 1227 006c 00000000 		.word	.LANCHOR5
 1228 0070 00000000 		.word	.LANCHOR10
 1229 0074 00000000 		.word	Position_Degree
 1230 0078 00000000 		.word	.LC3
 1231              		.cfi_endproc
 1232              	.LFE173:
 1234              		.section	.text.SVPWM_Normal_CalT1T2,"ax",%progbits
 1235              		.align	1
 1236              		.global	SVPWM_Normal_CalT1T2
 1237              		.syntax unified
 1238              		.thumb
 1239              		.thumb_func
 1240              		.fpu fpv4-sp-d16
 1242              	SVPWM_Normal_CalT1T2:
 1243              	.LVL73:
 1244              	.LFB175:
 245:Src/foc.c     ****     float temp = 0;
 1245              		.loc 1 245 1 is_stmt 1 view -0
 1246              		.cfi_startproc
 1247              		@ args = 0, pretend = 0, frame = 0
 1248              		@ frame_needed = 0, uses_anonymous_args = 0
 1249              		@ link register save eliminated.
 246:Src/foc.c     ****     switch (area)
 1250              		.loc 1 246 5 view .LVU307
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 37


 247:Src/foc.c     ****     {
 1251              		.loc 1 247 5 view .LVU308
 1252 0000 0138     		subs	r0, r0, #1
 1253              	.LVL74:
 247:Src/foc.c     ****     {
 1254              		.loc 1 247 5 is_stmt 0 view .LVU309
 1255 0002 0528     		cmp	r0, #5
 1256 0004 5BD8     		bhi	.L61
 1257 0006 DFE800F0 		tbb	[pc, r0]
 1258              	.L64:
 1259 000a 03       		.byte	(.L69-.L64)/2
 1260 000b 12       		.byte	(.L68-.L64)/2
 1261 000c 1F       		.byte	(.L67-.L64)/2
 1262 000d 30       		.byte	(.L66-.L64)/2
 1263 000e 3F       		.byte	(.L65-.L64)/2
 1264 000f 4C       		.byte	(.L63-.L64)/2
 1265              		.p2align 1
 1266              	.L69:
 250:Src/foc.c     ****         *t2 = 1.1547f * beta;
 1267              		.loc 1 250 9 is_stmt 1 view .LVU310
 250:Src/foc.c     ****         *t2 = 1.1547f * beta;
 1268              		.loc 1 250 32 is_stmt 0 view .LVU311
 1269 0010 DFED2B7A 		vldr.32	s15, .L70
 1270 0014 60EEA77A 		vmul.f32	s15, s1, s15
 250:Src/foc.c     ****         *t2 = 1.1547f * beta;
 1271              		.loc 1 250 21 view .LVU312
 1272 0018 30EE670A 		vsub.f32	s0, s0, s15
 1273              	.LVL75:
 250:Src/foc.c     ****         *t2 = 1.1547f * beta;
 1274              		.loc 1 250 13 view .LVU313
 1275 001c 81ED000A 		vstr.32	s0, [r1]
 251:Src/foc.c     ****         break;
 1276              		.loc 1 251 9 is_stmt 1 view .LVU314
 251:Src/foc.c     ****         break;
 1277              		.loc 1 251 23 is_stmt 0 view .LVU315
 1278 0020 DFED287A 		vldr.32	s15, .L70+4
 1279 0024 60EEA70A 		vmul.f32	s1, s1, s15
 1280              	.LVL76:
 251:Src/foc.c     ****         break;
 1281              		.loc 1 251 13 view .LVU316
 1282 0028 C2ED000A 		vstr.32	s1, [r2]
 252:Src/foc.c     ****     case 2:
 1283              		.loc 1 252 9 is_stmt 1 view .LVU317
 1284 002c 7047     		bx	lr
 1285              	.LVL77:
 1286              	.L68:
 254:Src/foc.c     ****         *t2 = 0.57735f * beta - alpha;
 1287              		.loc 1 254 9 view .LVU318
 254:Src/foc.c     ****         *t2 = 0.57735f * beta - alpha;
 1288              		.loc 1 254 32 is_stmt 0 view .LVU319
 1289 002e DFED247A 		vldr.32	s15, .L70
 1290 0032 60EEA70A 		vmul.f32	s1, s1, s15
 1291              	.LVL78:
 254:Src/foc.c     ****         *t2 = 0.57735f * beta - alpha;
 1292              		.loc 1 254 21 view .LVU320
 1293 0036 70EE807A 		vadd.f32	s15, s1, s0
 254:Src/foc.c     ****         *t2 = 0.57735f * beta - alpha;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 38


 1294              		.loc 1 254 13 view .LVU321
 1295 003a C1ED007A 		vstr.32	s15, [r1]
 255:Src/foc.c     ****         break;
 1296              		.loc 1 255 9 is_stmt 1 view .LVU322
 255:Src/foc.c     ****         break;
 1297              		.loc 1 255 31 is_stmt 0 view .LVU323
 1298 003e 70EEC00A 		vsub.f32	s1, s1, s0
 255:Src/foc.c     ****         break;
 1299              		.loc 1 255 13 view .LVU324
 1300 0042 C2ED000A 		vstr.32	s1, [r2]
 256:Src/foc.c     ****     case 3:
 1301              		.loc 1 256 9 is_stmt 1 view .LVU325
 1302 0046 7047     		bx	lr
 1303              	.LVL79:
 1304              	.L67:
 258:Src/foc.c     ****         *t2 = -alpha - 0.57735f * beta;
 1305              		.loc 1 258 9 view .LVU326
 258:Src/foc.c     ****         *t2 = -alpha - 0.57735f * beta;
 1306              		.loc 1 258 23 is_stmt 0 view .LVU327
 1307 0048 DFED1E7A 		vldr.32	s15, .L70+4
 1308 004c 60EEA77A 		vmul.f32	s15, s1, s15
 258:Src/foc.c     ****         *t2 = -alpha - 0.57735f * beta;
 1309              		.loc 1 258 13 view .LVU328
 1310 0050 C1ED007A 		vstr.32	s15, [r1]
 259:Src/foc.c     ****         break;
 1311              		.loc 1 259 9 is_stmt 1 view .LVU329
 259:Src/foc.c     ****         break;
 1312              		.loc 1 259 15 is_stmt 0 view .LVU330
 1313 0054 B1EE400A 		vneg.f32	s0, s0
 1314              	.LVL80:
 259:Src/foc.c     ****         break;
 1315              		.loc 1 259 33 view .LVU331
 1316 0058 DFED197A 		vldr.32	s15, .L70
 1317 005c 60EEA70A 		vmul.f32	s1, s1, s15
 1318              	.LVL81:
 259:Src/foc.c     ****         break;
 1319              		.loc 1 259 22 view .LVU332
 1320 0060 70EE600A 		vsub.f32	s1, s0, s1
 259:Src/foc.c     ****         break;
 1321              		.loc 1 259 13 view .LVU333
 1322 0064 C2ED000A 		vstr.32	s1, [r2]
 260:Src/foc.c     ****     case 4:
 1323              		.loc 1 260 9 is_stmt 1 view .LVU334
 1324 0068 7047     		bx	lr
 1325              	.LVL82:
 1326              	.L66:
 262:Src/foc.c     ****         *t2 = -1.1547f * beta;
 1327              		.loc 1 262 9 view .LVU335
 262:Src/foc.c     ****         *t2 = -1.1547f * beta;
 1328              		.loc 1 262 24 is_stmt 0 view .LVU336
 1329 006a DFED157A 		vldr.32	s15, .L70
 1330 006e 60EEA77A 		vmul.f32	s15, s1, s15
 262:Src/foc.c     ****         *t2 = -1.1547f * beta;
 1331              		.loc 1 262 31 view .LVU337
 1332 0072 37EEC00A 		vsub.f32	s0, s15, s0
 1333              	.LVL83:
 262:Src/foc.c     ****         *t2 = -1.1547f * beta;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 39


 1334              		.loc 1 262 13 view .LVU338
 1335 0076 81ED000A 		vstr.32	s0, [r1]
 263:Src/foc.c     ****         break;
 1336              		.loc 1 263 9 is_stmt 1 view .LVU339
 263:Src/foc.c     ****         break;
 1337              		.loc 1 263 24 is_stmt 0 view .LVU340
 1338 007a DFED137A 		vldr.32	s15, .L70+8
 1339 007e 60EEA70A 		vmul.f32	s1, s1, s15
 1340              	.LVL84:
 263:Src/foc.c     ****         break;
 1341              		.loc 1 263 13 view .LVU341
 1342 0082 C2ED000A 		vstr.32	s1, [r2]
 264:Src/foc.c     ****     case 5:
 1343              		.loc 1 264 9 is_stmt 1 view .LVU342
 1344 0086 7047     		bx	lr
 1345              	.LVL85:
 1346              	.L65:
 266:Src/foc.c     ****         *t1 = temp - alpha;
 1347              		.loc 1 266 9 view .LVU343
 266:Src/foc.c     ****         *t1 = temp - alpha;
 1348              		.loc 1 266 14 is_stmt 0 view .LVU344
 1349 0088 DFED107A 		vldr.32	s15, .L70+12
 1350 008c 60EEA70A 		vmul.f32	s1, s1, s15
 1351              	.LVL86:
 267:Src/foc.c     ****         *t2 = temp + alpha;
 1352              		.loc 1 267 9 is_stmt 1 view .LVU345
 267:Src/foc.c     ****         *t2 = temp + alpha;
 1353              		.loc 1 267 20 is_stmt 0 view .LVU346
 1354 0090 70EEC07A 		vsub.f32	s15, s1, s0
 267:Src/foc.c     ****         *t2 = temp + alpha;
 1355              		.loc 1 267 13 view .LVU347
 1356 0094 C1ED007A 		vstr.32	s15, [r1]
 268:Src/foc.c     ****         break;
 1357              		.loc 1 268 9 is_stmt 1 view .LVU348
 268:Src/foc.c     ****         break;
 1358              		.loc 1 268 20 is_stmt 0 view .LVU349
 1359 0098 70EE200A 		vadd.f32	s1, s0, s1
 1360              	.LVL87:
 268:Src/foc.c     ****         break;
 1361              		.loc 1 268 13 view .LVU350
 1362 009c C2ED000A 		vstr.32	s1, [r2]
 269:Src/foc.c     ****     case 6:
 1363              		.loc 1 269 9 is_stmt 1 view .LVU351
 1364 00a0 7047     		bx	lr
 1365              	.LVL88:
 1366              	.L63:
 271:Src/foc.c     ****         *t2 = alpha + 0.57735f * beta;
 1367              		.loc 1 271 9 view .LVU352
 271:Src/foc.c     ****         *t2 = alpha + 0.57735f * beta;
 1368              		.loc 1 271 24 is_stmt 0 view .LVU353
 1369 00a2 DFED097A 		vldr.32	s15, .L70+8
 1370 00a6 60EEA77A 		vmul.f32	s15, s1, s15
 271:Src/foc.c     ****         *t2 = alpha + 0.57735f * beta;
 1371              		.loc 1 271 13 view .LVU354
 1372 00aa C1ED007A 		vstr.32	s15, [r1]
 272:Src/foc.c     ****         break;
 1373              		.loc 1 272 9 is_stmt 1 view .LVU355
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 40


 272:Src/foc.c     ****         break;
 1374              		.loc 1 272 32 is_stmt 0 view .LVU356
 1375 00ae DFED047A 		vldr.32	s15, .L70
 1376 00b2 60EEA77A 		vmul.f32	s15, s1, s15
 272:Src/foc.c     ****         break;
 1377              		.loc 1 272 21 view .LVU357
 1378 00b6 77EE800A 		vadd.f32	s1, s15, s0
 1379              	.LVL89:
 272:Src/foc.c     ****         break;
 1380              		.loc 1 272 13 view .LVU358
 1381 00ba C2ED000A 		vstr.32	s1, [r2]
 273:Src/foc.c     ****     }
 1382              		.loc 1 273 9 is_stmt 1 view .LVU359
 1383              	.L61:
 275:Src/foc.c     **** 
 1384              		.loc 1 275 1 is_stmt 0 view .LVU360
 1385 00be 7047     		bx	lr
 1386              	.L71:
 1387              		.align	2
 1388              	.L70:
 1389 00c0 36CD133F 		.word	1058262326
 1390 00c4 36CD933F 		.word	1066650934
 1391 00c8 36CD93BF 		.word	-1080832714
 1392 00cc 36CD13BF 		.word	-1089221322
 1393              		.cfi_endproc
 1394              	.LFE175:
 1396              		.section	.text.SVPWM,"ax",%progbits
 1397              		.align	1
 1398              		.syntax unified
 1399              		.thumb
 1400              		.thumb_func
 1401              		.fpu fpv4-sp-d16
 1403              	SVPWM:
 1404              	.LVL90:
 1405              	.LFB180:
 365:Src/foc.c     ****     Uvect_Mos u1, u2;
 1406              		.loc 1 365 1 is_stmt 1 view -0
 1407              		.cfi_startproc
 1408              		@ args = 0, pretend = 0, frame = 48
 1409              		@ frame_needed = 0, uses_anonymous_args = 0
 365:Src/foc.c     ****     Uvect_Mos u1, u2;
 1410              		.loc 1 365 1 is_stmt 0 view .LVU362
 1411 0000 70B5     		push	{r4, r5, r6, lr}
 1412              	.LCFI27:
 1413              		.cfi_def_cfa_offset 16
 1414              		.cfi_offset 4, -16
 1415              		.cfi_offset 5, -12
 1416              		.cfi_offset 6, -8
 1417              		.cfi_offset 14, -4
 1418 0002 2DED028B 		vpush.64	{d8}
 1419              	.LCFI28:
 1420              		.cfi_def_cfa_offset 24
 1421              		.cfi_offset 80, -24
 1422              		.cfi_offset 81, -20
 1423 0006 90B0     		sub	sp, sp, #64
 1424              	.LCFI29:
 1425              		.cfi_def_cfa_offset 88
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 41


 1426 0008 F0EE408A 		vmov.f32	s17, s0
 1427 000c B0EE608A 		vmov.f32	s16, s1
 366:Src/foc.c     ****     float x, y;
 1428              		.loc 1 366 5 is_stmt 1 view .LVU363
 367:Src/foc.c     ****     float t1, t2;
 1429              		.loc 1 367 5 view .LVU364
 368:Src/foc.c     ****     static CCR_Duty CCR_Dutys = {0};
 1430              		.loc 1 368 5 view .LVU365
 369:Src/foc.c     **** 
 1431              		.loc 1 369 5 view .LVU366
 371:Src/foc.c     ****     get_area_u(area, &u1, &u2);
 1432              		.loc 1 371 5 view .LVU367
 371:Src/foc.c     ****     get_area_u(area, &u1, &u2);
 1433              		.loc 1 371 20 is_stmt 0 view .LVU368
 1434 0010 FCEEC07A 		vcvt.u32.f32	s15, s0
 1435 0014 17EE900A 		vmov	r0, s15	@ int
 1436 0018 FFF7FEFF 		bl	get_area
 1437              	.LVL91:
 371:Src/foc.c     ****     get_area_u(area, &u1, &u2);
 1438              		.loc 1 371 20 view .LVU369
 1439 001c 0646     		mov	r6, r0
 1440              	.LVL92:
 372:Src/foc.c     ****     arm_sin_cos_f32(Target_U, &y, &x);
 1441              		.loc 1 372 5 is_stmt 1 view .LVU370
 1442 001e 08AD     		add	r5, sp, #32
 1443 0020 0CAC     		add	r4, sp, #48
 1444 0022 2A46     		mov	r2, r5
 1445 0024 2146     		mov	r1, r4
 1446 0026 FFF7FEFF 		bl	get_area_u
 1447              	.LVL93:
 373:Src/foc.c     ****     x *= 0.86f * duty;
 1448              		.loc 1 373 5 view .LVU371
 1449 002a 07A9     		add	r1, sp, #28
 1450 002c 06A8     		add	r0, sp, #24
 1451 002e B0EE680A 		vmov.f32	s0, s17
 1452 0032 FFF7FEFF 		bl	arm_sin_cos_f32
 1453              	.LVL94:
 374:Src/foc.c     ****     y *= 0.86f * duty; // sqrt(3)/2 Ê≤°Èîô
 1454              		.loc 1 374 5 view .LVU372
 374:Src/foc.c     ****     y *= 0.86f * duty; // sqrt(3)/2 Ê≤°Èîô
 1455              		.loc 1 374 16 is_stmt 0 view .LVU373
 1456 0036 DFED170A 		vldr.32	s1, .L74
 1457 003a 68EE200A 		vmul.f32	s1, s16, s1
 374:Src/foc.c     ****     y *= 0.86f * duty; // sqrt(3)/2 Ê≤°Èîô
 1458              		.loc 1 374 7 view .LVU374
 1459 003e 9DED070A 		vldr.32	s0, [sp, #28]
 1460 0042 20EE800A 		vmul.f32	s0, s1, s0
 1461 0046 8DED070A 		vstr.32	s0, [sp, #28]
 375:Src/foc.c     ****     SVPWM_Normal_CalT1T2(x, y, area, &t1, &t2);
 1462              		.loc 1 375 5 is_stmt 1 view .LVU375
 375:Src/foc.c     ****     SVPWM_Normal_CalT1T2(x, y, area, &t1, &t2);
 1463              		.loc 1 375 7 is_stmt 0 view .LVU376
 1464 004a DDED067A 		vldr.32	s15, [sp, #24]
 1465 004e 60EEA70A 		vmul.f32	s1, s1, s15
 1466 0052 CDED060A 		vstr.32	s1, [sp, #24]
 376:Src/foc.c     ****     CCR_Dutys = get_ccr_duty(t1, t2, u1, u2);
 1467              		.loc 1 376 5 is_stmt 1 view .LVU377
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 42


 1468 0056 04AA     		add	r2, sp, #16
 1469 0058 05A9     		add	r1, sp, #20
 1470 005a 3046     		mov	r0, r6
 1471 005c FFF7FEFF 		bl	SVPWM_Normal_CalT1T2
 1472              	.LVL95:
 377:Src/foc.c     ****     SVPWM_Step(CCR_Dutys);
 1473              		.loc 1 377 5 view .LVU378
 377:Src/foc.c     ****     SVPWM_Step(CCR_Dutys);
 1474              		.loc 1 377 17 is_stmt 0 view .LVU379
 1475 0060 95E80F00 		ldm	r5, {r0, r1, r2, r3}
 1476 0064 8DE80F00 		stm	sp, {r0, r1, r2, r3}
 1477 0068 94E80F00 		ldm	r4, {r0, r1, r2, r3}
 1478 006c DDED040A 		vldr.32	s1, [sp, #16]
 1479 0070 9DED050A 		vldr.32	s0, [sp, #20]
 1480 0074 FFF7FEFF 		bl	get_ccr_duty
 1481              	.LVL96:
 1482 0078 074B     		ldr	r3, .L74+4
 1483 007a 83ED000A 		vstr.32	s0, [r3]
 1484 007e C3ED010A 		vstr.32	s1, [r3, #4]
 1485 0082 83ED021A 		vstr.32	s2, [r3, #8]
 378:Src/foc.c     **** }
 1486              		.loc 1 378 5 is_stmt 1 view .LVU380
 1487 0086 FFF7FEFF 		bl	SVPWM_Step
 1488              	.LVL97:
 379:Src/foc.c     **** 
 1489              		.loc 1 379 1 is_stmt 0 view .LVU381
 1490 008a 10B0     		add	sp, sp, #64
 1491              	.LCFI30:
 1492              		.cfi_def_cfa_offset 24
 1493              		@ sp needed
 1494 008c BDEC028B 		vldm	sp!, {d8}
 1495              	.LCFI31:
 1496              		.cfi_restore 80
 1497              		.cfi_restore 81
 1498              		.cfi_def_cfa_offset 16
 1499              	.LVL98:
 379:Src/foc.c     **** 
 1500              		.loc 1 379 1 view .LVU382
 1501 0090 70BD     		pop	{r4, r5, r6, pc}
 1502              	.LVL99:
 1503              	.L75:
 379:Src/foc.c     **** 
 1504              		.loc 1 379 1 view .LVU383
 1505 0092 00BF     		.align	2
 1506              	.L74:
 1507 0094 F6285C3F 		.word	1063004406
 1508 0098 00000000 		.word	.LANCHOR11
 1509              		.cfi_endproc
 1510              	.LFE180:
 1512              		.section	.text.Park_Conv,"ax",%progbits
 1513              		.align	1
 1514              		.global	Park_Conv
 1515              		.syntax unified
 1516              		.thumb
 1517              		.thumb_func
 1518              		.fpu fpv4-sp-d16
 1520              	Park_Conv:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 43


 1521              	.LVL100:
 1522              	.LFB177:
 314:Src/foc.c     ****     *ialpha = ia;
 1523              		.loc 1 314 1 is_stmt 1 view -0
 1524              		.cfi_startproc
 1525              		@ args = 0, pretend = 0, frame = 0
 1526              		@ frame_needed = 0, uses_anonymous_args = 0
 1527              		@ link register save eliminated.
 315:Src/foc.c     ****     *ibeta = (sqrtf(3) * ib + sqrtf(3) * (ib + ia)) / 3.0f;
 1528              		.loc 1 315 5 view .LVU385
 315:Src/foc.c     ****     *ibeta = (sqrtf(3) * ib + sqrtf(3) * (ib + ia)) / 3.0f;
 1529              		.loc 1 315 13 is_stmt 0 view .LVU386
 1530 0000 80ED000A 		vstr.32	s0, [r0]
 316:Src/foc.c     **** }
 1531              		.loc 1 316 5 is_stmt 1 view .LVU387
 316:Src/foc.c     **** }
 1532              		.loc 1 316 24 is_stmt 0 view .LVU388
 1533 0004 9FED087A 		vldr.32	s14, .L77
 1534 0008 60EE877A 		vmul.f32	s15, s1, s14
 316:Src/foc.c     **** }
 1535              		.loc 1 316 46 view .LVU389
 1536 000c 30EE200A 		vadd.f32	s0, s0, s1
 1537              	.LVL101:
 316:Src/foc.c     **** }
 1538              		.loc 1 316 40 view .LVU390
 1539 0010 20EE070A 		vmul.f32	s0, s0, s14
 316:Src/foc.c     **** }
 1540              		.loc 1 316 29 view .LVU391
 1541 0014 37EE800A 		vadd.f32	s0, s15, s0
 316:Src/foc.c     **** }
 1542              		.loc 1 316 53 view .LVU392
 1543 0018 B0EE087A 		vmov.f32	s14, #3.0e+0
 1544 001c C0EE077A 		vdiv.f32	s15, s0, s14
 316:Src/foc.c     **** }
 1545              		.loc 1 316 12 view .LVU393
 1546 0020 C1ED007A 		vstr.32	s15, [r1]
 1547              	.LVL102:
 317:Src/foc.c     **** 
 1548              		.loc 1 317 1 view .LVU394
 1549 0024 7047     		bx	lr
 1550              	.L78:
 1551 0026 00BF     		.align	2
 1552              	.L77:
 1553 0028 D7B3DD3F 		.word	1071494103
 1554              		.cfi_endproc
 1555              	.LFE177:
 1557              		.section	.text.HAL_ADC_ConvCpltCallback,"ax",%progbits
 1558              		.align	1
 1559              		.global	HAL_ADC_ConvCpltCallback
 1560              		.syntax unified
 1561              		.thumb
 1562              		.thumb_func
 1563              		.fpu fpv4-sp-d16
 1565              	HAL_ADC_ConvCpltCallback:
 1566              	.LVL103:
 1567              	.LFB178:
 320:Src/foc.c     ****     float ia, ib;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 44


 1568              		.loc 1 320 1 is_stmt 1 view -0
 1569              		.cfi_startproc
 1570              		@ args = 0, pretend = 0, frame = 0
 1571              		@ frame_needed = 0, uses_anonymous_args = 0
 320:Src/foc.c     ****     float ia, ib;
 1572              		.loc 1 320 1 is_stmt 0 view .LVU396
 1573 0000 08B5     		push	{r3, lr}
 1574              	.LCFI32:
 1575              		.cfi_def_cfa_offset 8
 1576              		.cfi_offset 3, -8
 1577              		.cfi_offset 14, -4
 321:Src/foc.c     **** 
 1578              		.loc 1 321 5 is_stmt 1 view .LVU397
 323:Src/foc.c     ****     {
 1579              		.loc 1 323 5 view .LVU398
 323:Src/foc.c     ****     {
 1580              		.loc 1 323 13 is_stmt 0 view .LVU399
 1581 0002 0368     		ldr	r3, [r0]
 323:Src/foc.c     ****     {
 1582              		.loc 1 323 8 view .LVU400
 1583 0004 1B4A     		ldr	r2, .L85
 1584 0006 9342     		cmp	r3, r2
 1585 0008 03D0     		beq	.L79
 326:Src/foc.c     ****     {
 1586              		.loc 1 326 10 is_stmt 1 view .LVU401
 326:Src/foc.c     ****     {
 1587              		.loc 1 326 13 is_stmt 0 view .LVU402
 1588 000a 02F58072 		add	r2, r2, #256
 1589 000e 9342     		cmp	r3, r2
 1590 0010 00D0     		beq	.L83
 1591              	.LVL104:
 1592              	.L79:
 336:Src/foc.c     **** 
 1593              		.loc 1 336 1 view .LVU403
 1594 0012 08BD     		pop	{r3, pc}
 1595              	.LVL105:
 1596              	.L83:
 328:Src/foc.c     ****         {
 1597              		.loc 1 328 9 is_stmt 1 view .LVU404
 328:Src/foc.c     ****         {
 1598              		.loc 1 328 24 is_stmt 0 view .LVU405
 1599 0014 184B     		ldr	r3, .L85+4
 1600 0016 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 328:Src/foc.c     ****         {
 1601              		.loc 1 328 12 view .LVU406
 1602 0018 022B     		cmp	r3, #2
 1603 001a 02D0     		beq	.L84
 1604              	.LVL106:
 1605              	.L81:
 334:Src/foc.c     ****     }
 1606              		.loc 1 334 9 is_stmt 1 view .LVU407
 1607 001c FFF7FEFF 		bl	Measure_R_20Khz_Handler
 1608              	.LVL107:
 336:Src/foc.c     **** 
 1609              		.loc 1 336 1 is_stmt 0 view .LVU408
 1610 0020 F7E7     		b	.L79
 1611              	.LVL108:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 45


 1612              	.L84:
 330:Src/foc.c     ****             ib = ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 1613              		.loc 1 330 13 is_stmt 1 view .LVU409
 330:Src/foc.c     ****             ib = ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 1614              		.loc 1 330 18 is_stmt 0 view .LVU410
 1615 0022 164B     		ldr	r3, .L85+8
 1616 0024 1A88     		ldrh	r2, [r3]
 1617 0026 07EE102A 		vmov	s14, r2	@ int
 1618 002a B8EEC77A 		vcvt.f32.s32	s14, s14
 1619 002e DFED145A 		vldr.32	s11, .L85+12
 1620 0032 27EE257A 		vmul.f32	s14, s14, s11
 1621 0036 9FED136A 		vldr.32	s12, .L85+16
 1622 003a 27EE067A 		vmul.f32	s14, s14, s12
 1623 003e DFED126A 		vldr.32	s13, .L85+20
 1624 0042 87EE260A 		vdiv.f32	s0, s14, s13
 330:Src/foc.c     ****             ib = ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 1625              		.loc 1 330 16 view .LVU411
 1626 0046 9FED117A 		vldr.32	s14, .L85+24
 1627              	.LVL109:
 331:Src/foc.c     ****             Park_Conv(ia, ib, &Ialpha, &Ibeta);
 1628              		.loc 1 331 13 is_stmt 1 view .LVU412
 331:Src/foc.c     ****             Park_Conv(ia, ib, &Ialpha, &Ibeta);
 1629              		.loc 1 331 18 is_stmt 0 view .LVU413
 1630 004a 5B88     		ldrh	r3, [r3, #2]
 1631 004c 07EE903A 		vmov	s15, r3	@ int
 1632 0050 F8EEE77A 		vcvt.f32.s32	s15, s15
 1633 0054 67EEA57A 		vmul.f32	s15, s15, s11
 1634 0058 67EE867A 		vmul.f32	s15, s15, s12
 1635 005c C7EEA60A 		vdiv.f32	s1, s15, s13
 1636              	.LVL110:
 332:Src/foc.c     ****         }
 1637              		.loc 1 332 13 is_stmt 1 view .LVU414
 1638 0060 0B49     		ldr	r1, .L85+28
 1639 0062 0C48     		ldr	r0, .L85+32
 1640              	.LVL111:
 332:Src/foc.c     ****         }
 1641              		.loc 1 332 13 is_stmt 0 view .LVU415
 1642 0064 C0EE870A 		vdiv.f32	s1, s1, s14
 1643              	.LVL112:
 332:Src/foc.c     ****         }
 1644              		.loc 1 332 13 view .LVU416
 1645 0068 80EE070A 		vdiv.f32	s0, s0, s14
 1646              	.LVL113:
 332:Src/foc.c     ****         }
 1647              		.loc 1 332 13 view .LVU417
 1648 006c FFF7FEFF 		bl	Park_Conv
 1649              	.LVL114:
 332:Src/foc.c     ****         }
 1650              		.loc 1 332 13 view .LVU418
 1651 0070 D4E7     		b	.L81
 1652              	.L86:
 1653 0072 00BF     		.align	2
 1654              	.L85:
 1655 0074 00200140 		.word	1073815552
 1656 0078 00000000 		.word	Board_Mode
 1657 007c 00000000 		.word	ADC_Values_Raw2
 1658 0080 00404E45 		.word	1162756096
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 46


 1659 0084 00008039 		.word	964689920
 1660 0088 00004843 		.word	1128792064
 1661 008c A69B443B 		.word	994352038
 1662 0090 00000000 		.word	Ibeta
 1663 0094 00000000 		.word	Ialpha
 1664              		.cfi_endproc
 1665              	.LFE178:
 1667              		.section	.text.Foc,"ax",%progbits
 1668              		.align	1
 1669              		.global	Foc
 1670              		.syntax unified
 1671              		.thumb
 1672              		.thumb_func
 1673              		.fpu fpv4-sp-d16
 1675              	Foc:
 1676              	.LFB179:
 339:Src/foc.c     ****     Uvect_Mos u1, u2;
 1677              		.loc 1 339 1 is_stmt 1 view -0
 1678              		.cfi_startproc
 1679              		@ args = 0, pretend = 0, frame = 0
 1680              		@ frame_needed = 0, uses_anonymous_args = 0
 1681 0000 08B5     		push	{r3, lr}
 1682              	.LCFI33:
 1683              		.cfi_def_cfa_offset 8
 1684              		.cfi_offset 3, -8
 1685              		.cfi_offset 14, -4
 340:Src/foc.c     ****     float t1, t2;
 1686              		.loc 1 340 5 view .LVU420
 341:Src/foc.c     ****     float x, y;
 1687              		.loc 1 341 5 view .LVU421
 342:Src/foc.c     **** 
 1688              		.loc 1 342 5 view .LVU422
 344:Src/foc.c     ****     float electric_position_offset = (-1 * Position_Offset + 360);
 1689              		.loc 1 344 5 view .LVU423
 344:Src/foc.c     ****     float electric_position_offset = (-1 * Position_Offset + 360);
 1690              		.loc 1 344 53 is_stmt 0 view .LVU424
 1691 0002 184B     		ldr	r3, .L91
 1692 0004 D3ED007A 		vldr.32	s15, [r3]
 344:Src/foc.c     ****     float electric_position_offset = (-1 * Position_Offset + 360);
 1693              		.loc 1 344 11 view .LVU425
 1694 0008 9FED177A 		vldr.32	s14, .L91+4
 1695 000c 77EE677A 		vsub.f32	s15, s14, s15
 1696              	.LVL115:
 345:Src/foc.c     ****     //float electric_position=Position_Degree;
 1697              		.loc 1 345 5 is_stmt 1 view .LVU426
 345:Src/foc.c     ****     //float electric_position=Position_Degree;
 1698              		.loc 1 345 60 is_stmt 0 view .LVU427
 1699 0010 164B     		ldr	r3, .L91+8
 1700 0012 D3ED006A 		vldr.32	s13, [r3]
 345:Src/foc.c     ****     //float electric_position=Position_Degree;
 1701              		.loc 1 345 11 view .LVU428
 1702 0016 37EE667A 		vsub.f32	s14, s14, s13
 1703              	.LVL116:
 348:Src/foc.c     **** 
 1704              		.loc 1 348 5 is_stmt 1 view .LVU429
 348:Src/foc.c     **** 
 1705              		.loc 1 348 47 is_stmt 0 view .LVU430
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 47


 1706 001a 77EEC77A 		vsub.f32	s15, s15, s14
 1707              	.LVL117:
 348:Src/foc.c     **** 
 1708              		.loc 1 348 13 view .LVU431
 1709 001e FDEEE77A 		vcvt.s32.f32	s15, s15
 1710 0022 17EE903A 		vmov	r3, s15	@ int
 1711              	.LVL118:
 350:Src/foc.c     ****     {
 1712              		.loc 1 350 5 is_stmt 1 view .LVU432
 350:Src/foc.c     ****     {
 1713              		.loc 1 350 8 is_stmt 0 view .LVU433
 1714 0026 002B     		cmp	r3, #0
 1715 0028 18DB     		blt	.L90
 1716              	.L88:
 354:Src/foc.c     ****     sub += 90;
 1717              		.loc 1 354 5 is_stmt 1 view .LVU434
 354:Src/foc.c     ****     sub += 90;
 1718              		.loc 1 354 17 is_stmt 0 view .LVU435
 1719 002a 114A     		ldr	r2, .L91+12
 1720 002c 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 354:Src/foc.c     ****     sub += 90;
 1721              		.loc 1 354 9 view .LVU436
 1722 002e 03FB02F3 		mul	r3, r3, r2
 1723              	.LVL119:
 355:Src/foc.c     **** 
 1724              		.loc 1 355 5 is_stmt 1 view .LVU437
 355:Src/foc.c     **** 
 1725              		.loc 1 355 9 is_stmt 0 view .LVU438
 1726 0032 5A33     		adds	r3, r3, #90
 1727              	.LVL120:
 357:Src/foc.c     **** 
 1728              		.loc 1 357 5 is_stmt 1 view .LVU439
 357:Src/foc.c     **** 
 1729              		.loc 1 357 9 is_stmt 0 view .LVU440
 1730 0034 0F4A     		ldr	r2, .L91+16
 1731 0036 82FB0312 		smull	r1, r2, r2, r3
 1732 003a D118     		adds	r1, r2, r3
 1733 003c DA17     		asrs	r2, r3, #31
 1734 003e C2EB2122 		rsb	r2, r2, r1, asr #8
 1735 0042 4FF4B471 		mov	r1, #360
 1736 0046 01FB1232 		mls	r2, r1, r2, r3
 1737              	.LVL121:
 359:Src/foc.c     **** }
 1738              		.loc 1 359 5 is_stmt 1 view .LVU441
 1739 004a F7EE000A 		vmov.f32	s1, #1.0e+0
 1740 004e 07EE902A 		vmov	s15, r2	@ int
 1741 0052 B8EEE70A 		vcvt.f32.s32	s0, s15
 1742 0056 FFF7FEFF 		bl	SVPWM
 1743              	.LVL122:
 360:Src/foc.c     **** 
 1744              		.loc 1 360 1 is_stmt 0 view .LVU442
 1745 005a 08BD     		pop	{r3, pc}
 1746              	.LVL123:
 1747              	.L90:
 352:Src/foc.c     ****     }
 1748              		.loc 1 352 9 is_stmt 1 view .LVU443
 352:Src/foc.c     ****     }
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 48


 1749              		.loc 1 352 13 is_stmt 0 view .LVU444
 1750 005c 03F5B473 		add	r3, r3, #360
 1751              	.LVL124:
 352:Src/foc.c     ****     }
 1752              		.loc 1 352 13 view .LVU445
 1753 0060 E3E7     		b	.L88
 1754              	.L92:
 1755 0062 00BF     		.align	2
 1756              	.L91:
 1757 0064 00000000 		.word	Position_Degree
 1758 0068 0000B443 		.word	1135869952
 1759 006c 00000000 		.word	.LANCHOR12
 1760 0070 00000000 		.word	.LANCHOR13
 1761 0074 B7600BB6 		.word	-1240768329
 1762              		.cfi_endproc
 1763              	.LFE179:
 1765              		.section	.text.VF_Openloop_Control,"ax",%progbits
 1766              		.align	1
 1767              		.global	VF_Openloop_Control
 1768              		.syntax unified
 1769              		.thumb
 1770              		.thumb_func
 1771              		.fpu fpv4-sp-d16
 1773              	VF_Openloop_Control:
 1774              	.LVL125:
 1775              	.LFB181:
 382:Src/foc.c     ****     static float theta = 0;
 1776              		.loc 1 382 1 is_stmt 1 view -0
 1777              		.cfi_startproc
 1778              		@ args = 0, pretend = 0, frame = 0
 1779              		@ frame_needed = 0, uses_anonymous_args = 0
 382:Src/foc.c     ****     static float theta = 0;
 1780              		.loc 1 382 1 is_stmt 0 view .LVU447
 1781 0000 08B5     		push	{r3, lr}
 1782              	.LCFI34:
 1783              		.cfi_def_cfa_offset 8
 1784              		.cfi_offset 3, -8
 1785              		.cfi_offset 14, -4
 1786 0002 07EE100A 		vmov	s14, r0	@ int
 383:Src/foc.c     ****     float delta_p = rps * Motor.pairs * 360.0f / freq; // ÊØèÊ¨°Ë∞ÉÁî®Êú¨ÂáΩÊï∞Ë¶ÅÂ¢ûÂä†ÁöÑÂÄº
 1787              		.loc 1 383 5 is_stmt 1 view .LVU448
 384:Src/foc.c     **** 
 1788              		.loc 1 384 5 view .LVU449
 384:Src/foc.c     **** 
 1789              		.loc 1 384 32 is_stmt 0 view .LVU450
 1790 0006 1B4B     		ldr	r3, .L102
 1791 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1792 000a 07EE903A 		vmov	s15, r3	@ int
 384:Src/foc.c     **** 
 1793              		.loc 1 384 25 view .LVU451
 1794 000e F8EEE77A 		vcvt.f32.s32	s15, s15
 1795 0012 27EE811A 		vmul.f32	s2, s15, s2
 1796              	.LVL126:
 384:Src/foc.c     **** 
 1797              		.loc 1 384 39 view .LVU452
 1798 0016 DFED186A 		vldr.32	s13, .L102+4
 1799 001a 21EE261A 		vmul.f32	s2, s2, s13
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 49


 384:Src/foc.c     **** 
 1800              		.loc 1 384 11 view .LVU453
 1801 001e 81EE206A 		vdiv.f32	s12, s2, s1
 1802              	.LVL127:
 386:Src/foc.c     ****     if (theta > 360)
 1803              		.loc 1 386 5 is_stmt 1 view .LVU454
 386:Src/foc.c     ****     if (theta > 360)
 1804              		.loc 1 386 24 is_stmt 0 view .LVU455
 1805 0022 F8EEC77A 		vcvt.f32.s32	s15, s14
 1806 0026 67EE867A 		vmul.f32	s15, s15, s12
 386:Src/foc.c     ****     if (theta > 360)
 1807              		.loc 1 386 11 view .LVU456
 1808 002a 144B     		ldr	r3, .L102+8
 1809 002c 93ED007A 		vldr.32	s14, [r3]
 1810 0030 77EE877A 		vadd.f32	s15, s15, s14
 1811 0034 C3ED007A 		vstr.32	s15, [r3]
 387:Src/foc.c     ****     {
 1812              		.loc 1 387 5 is_stmt 1 view .LVU457
 387:Src/foc.c     ****     {
 1813              		.loc 1 387 8 is_stmt 0 view .LVU458
 1814 0038 F4EEE67A 		vcmpe.f32	s15, s13
 1815 003c F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1816 0040 0BDD     		ble	.L100
 389:Src/foc.c     ****     }
 1817              		.loc 1 389 9 is_stmt 1 view .LVU459
 389:Src/foc.c     ****     }
 1818              		.loc 1 389 15 is_stmt 0 view .LVU460
 1819 0042 77EEE67A 		vsub.f32	s15, s15, s13
 1820 0046 C3ED007A 		vstr.32	s15, [r3]
 1821              	.L96:
 395:Src/foc.c     **** }
 1822              		.loc 1 395 5 is_stmt 1 view .LVU461
 1823 004a F0EE400A 		vmov.f32	s1, s0
 1824              	.LVL128:
 395:Src/foc.c     **** }
 1825              		.loc 1 395 5 is_stmt 0 view .LVU462
 1826 004e 0B4B     		ldr	r3, .L102+8
 1827 0050 93ED000A 		vldr.32	s0, [r3]
 1828              	.LVL129:
 395:Src/foc.c     **** }
 1829              		.loc 1 395 5 view .LVU463
 1830 0054 FFF7FEFF 		bl	SVPWM
 1831              	.LVL130:
 396:Src/foc.c     **** 
 1832              		.loc 1 396 1 view .LVU464
 1833 0058 08BD     		pop	{r3, pc}
 1834              	.LVL131:
 1835              	.L100:
 391:Src/foc.c     ****     {
 1836              		.loc 1 391 10 is_stmt 1 view .LVU465
 391:Src/foc.c     ****     {
 1837              		.loc 1 391 13 is_stmt 0 view .LVU466
 1838 005a F5EEC07A 		vcmpe.f32	s15, #0
 1839 005e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1840 0062 F2D5     		bpl	.L96
 393:Src/foc.c     ****     }
 1841              		.loc 1 393 9 is_stmt 1 view .LVU467
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 50


 393:Src/foc.c     ****     }
 1842              		.loc 1 393 15 is_stmt 0 view .LVU468
 1843 0064 9FED047A 		vldr.32	s14, .L102+4
 1844 0068 77EE877A 		vadd.f32	s15, s15, s14
 1845 006c 034B     		ldr	r3, .L102+8
 1846 006e C3ED007A 		vstr.32	s15, [r3]
 1847 0072 EAE7     		b	.L96
 1848              	.L103:
 1849              		.align	2
 1850              	.L102:
 1851 0074 00000000 		.word	.LANCHOR13
 1852 0078 0000B443 		.word	1135869952
 1853 007c 00000000 		.word	.LANCHOR14
 1854              		.cfi_endproc
 1855              	.LFE181:
 1857              		.section	.rodata.Test_Direction.str1.4,"aMS",%progbits,1
 1858              		.align	2
 1859              	.LC4:
 1860 0000 64697265 		.ascii	"direction result:%d\015\012\000"
 1860      6374696F 
 1860      6E207265 
 1860      73756C74 
 1860      3A25640D 
 1861 0016 0000     		.align	2
 1862              	.LC5:
 1863 0018 74686520 		.ascii	"the direction of the motor is postive!\015\012\000"
 1863      64697265 
 1863      6374696F 
 1863      6E206F66 
 1863      20746865 
 1864 0041 000000   		.align	2
 1865              	.LC6:
 1866 0044 74686520 		.ascii	"the direction of the motor is nagative!\015\012\000"
 1866      64697265 
 1866      6374696F 
 1866      6E206F66 
 1866      20746865 
 1867              		.section	.text.Test_Direction,"ax",%progbits
 1868              		.align	1
 1869              		.syntax unified
 1870              		.thumb
 1871              		.thumb_func
 1872              		.fpu fpv4-sp-d16
 1874              	Test_Direction:
 1875              	.LFB182:
 399:Src/foc.c     ****     Test_Direction_Info.time += 1;
 1876              		.loc 1 399 1 is_stmt 1 view -0
 1877              		.cfi_startproc
 1878              		@ args = 0, pretend = 0, frame = 0
 1879              		@ frame_needed = 0, uses_anonymous_args = 0
 1880 0000 10B5     		push	{r4, lr}
 1881              	.LCFI35:
 1882              		.cfi_def_cfa_offset 8
 1883              		.cfi_offset 4, -8
 1884              		.cfi_offset 14, -4
 400:Src/foc.c     **** 
 1885              		.loc 1 400 5 view .LVU470
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 51


 400:Src/foc.c     **** 
 1886              		.loc 1 400 30 is_stmt 0 view .LVU471
 1887 0002 224B     		ldr	r3, .L115
 1888 0004 1A68     		ldr	r2, [r3]
 1889 0006 0132     		adds	r2, r2, #1
 1890 0008 1A60     		str	r2, [r3]
 402:Src/foc.c     ****     {
 1891              		.loc 1 402 5 is_stmt 1 view .LVU472
 402:Src/foc.c     ****     {
 1892              		.loc 1 402 46 is_stmt 0 view .LVU473
 1893 000a 93ED017A 		vldr.32	s14, [r3, #4]
 402:Src/foc.c     ****     {
 1894              		.loc 1 402 25 view .LVU474
 1895 000e 204B     		ldr	r3, .L115+4
 1896 0010 D3ED007A 		vldr.32	s15, [r3]
 402:Src/foc.c     ****     {
 1897              		.loc 1 402 8 view .LVU475
 1898 0014 B4EEE77A 		vcmpe.f32	s14, s15
 1899 0018 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1900 001c 15D5     		bpl	.L112
 404:Src/foc.c     ****     }
 1901              		.loc 1 404 9 is_stmt 1 view .LVU476
 404:Src/foc.c     ****     }
 1902              		.loc 1 404 46 is_stmt 0 view .LVU477
 1903 001e 1B4A     		ldr	r2, .L115
 1904 0020 9368     		ldr	r3, [r2, #8]
 1905 0022 0133     		adds	r3, r3, #1
 1906 0024 9360     		str	r3, [r2, #8]
 1907              	.L107:
 410:Src/foc.c     **** 
 1908              		.loc 1 410 5 is_stmt 1 view .LVU478
 410:Src/foc.c     **** 
 1909              		.loc 1 410 39 is_stmt 0 view .LVU479
 1910 0026 194C     		ldr	r4, .L115
 1911 0028 C4ED017A 		vstr.32	s15, [r4, #4]
 412:Src/foc.c     **** 
 1912              		.loc 1 412 5 is_stmt 1 view .LVU480
 1913 002c B7EE001A 		vmov.f32	s2, #1.0e+0
 1914 0030 0120     		movs	r0, #1
 1915 0032 DFED180A 		vldr.32	s1, .L115+8
 1916 0036 B0EE410A 		vmov.f32	s0, s2
 1917 003a FFF7FEFF 		bl	VF_Openloop_Control
 1918              	.LVL132:
 414:Src/foc.c     ****     { // run 10s
 1919              		.loc 1 414 5 view .LVU481
 414:Src/foc.c     ****     { // run 10s
 1920              		.loc 1 414 28 is_stmt 0 view .LVU482
 1921 003e 2268     		ldr	r2, [r4]
 414:Src/foc.c     ****     { // run 10s
 1922              		.loc 1 414 8 view .LVU483
 1923 0040 42F21073 		movw	r3, #10000
 1924 0044 9A42     		cmp	r2, r3
 1925 0046 05D8     		bhi	.L114
 1926              	.L104:
 431:Src/foc.c     **** 
 1927              		.loc 1 431 1 view .LVU484
 1928 0048 10BD     		pop	{r4, pc}
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 52


 1929              	.L112:
 408:Src/foc.c     ****     }
 1930              		.loc 1 408 9 is_stmt 1 view .LVU485
 408:Src/foc.c     ****     }
 1931              		.loc 1 408 46 is_stmt 0 view .LVU486
 1932 004a 104A     		ldr	r2, .L115
 1933 004c 9368     		ldr	r3, [r2, #8]
 1934 004e 013B     		subs	r3, r3, #1
 1935 0050 9360     		str	r3, [r2, #8]
 1936 0052 E8E7     		b	.L107
 1937              	.L114:
 416:Src/foc.c     ****         Test_Direction_Info.time = 0;
 1938              		.loc 1 416 9 is_stmt 1 view .LVU487
 416:Src/foc.c     ****         Test_Direction_Info.time = 0;
 1939              		.loc 1 416 20 is_stmt 0 view .LVU488
 1940 0054 0023     		movs	r3, #0
 1941 0056 104A     		ldr	r2, .L115+12
 1942 0058 1370     		strb	r3, [r2]
 417:Src/foc.c     ****         uprintf_polling("direction result:%d\r\n", Test_Direction_Info.direction_result);
 1943              		.loc 1 417 9 is_stmt 1 view .LVU489
 417:Src/foc.c     ****         uprintf_polling("direction result:%d\r\n", Test_Direction_Info.direction_result);
 1944              		.loc 1 417 34 is_stmt 0 view .LVU490
 1945 005a 2360     		str	r3, [r4]
 418:Src/foc.c     ****         if (Test_Direction_Info.direction_result > 0)
 1946              		.loc 1 418 9 is_stmt 1 view .LVU491
 1947 005c A168     		ldr	r1, [r4, #8]
 1948 005e 0F48     		ldr	r0, .L115+16
 1949 0060 FFF7FEFF 		bl	uprintf_polling
 1950              	.LVL133:
 419:Src/foc.c     ****         {
 1951              		.loc 1 419 9 view .LVU492
 419:Src/foc.c     ****         {
 1952              		.loc 1 419 32 is_stmt 0 view .LVU493
 1953 0064 A368     		ldr	r3, [r4, #8]
 419:Src/foc.c     ****         {
 1954              		.loc 1 419 12 view .LVU494
 1955 0066 002B     		cmp	r3, #0
 1956 0068 09DD     		ble	.L109
 421:Src/foc.c     ****             Motor.direction = 1;
 1957              		.loc 1 421 13 is_stmt 1 view .LVU495
 1958 006a 0D48     		ldr	r0, .L115+20
 1959 006c FFF7FEFF 		bl	uprintf_polling
 1960              	.LVL134:
 422:Src/foc.c     ****         }
 1961              		.loc 1 422 13 view .LVU496
 422:Src/foc.c     ****         }
 1962              		.loc 1 422 29 is_stmt 0 view .LVU497
 1963 0070 0C4B     		ldr	r3, .L115+24
 1964 0072 0122     		movs	r2, #1
 1965 0074 1A73     		strb	r2, [r3, #12]
 1966              	.L110:
 429:Src/foc.c     ****     }
 1967              		.loc 1 429 9 is_stmt 1 view .LVU498
 429:Src/foc.c     ****     }
 1968              		.loc 1 429 46 is_stmt 0 view .LVU499
 1969 0076 054B     		ldr	r3, .L115
 1970 0078 0022     		movs	r2, #0
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 53


 1971 007a 9A60     		str	r2, [r3, #8]
 431:Src/foc.c     **** 
 1972              		.loc 1 431 1 view .LVU500
 1973 007c E4E7     		b	.L104
 1974              	.L109:
 426:Src/foc.c     ****             Motor.direction = -1;
 1975              		.loc 1 426 13 is_stmt 1 view .LVU501
 1976 007e 0A48     		ldr	r0, .L115+28
 1977 0080 FFF7FEFF 		bl	uprintf_polling
 1978              	.LVL135:
 427:Src/foc.c     ****         }
 1979              		.loc 1 427 13 view .LVU502
 427:Src/foc.c     ****         }
 1980              		.loc 1 427 29 is_stmt 0 view .LVU503
 1981 0084 074B     		ldr	r3, .L115+24
 1982 0086 FF22     		movs	r2, #255
 1983 0088 1A73     		strb	r2, [r3, #12]
 1984 008a F4E7     		b	.L110
 1985              	.L116:
 1986              		.align	2
 1987              	.L115:
 1988 008c 00000000 		.word	Test_Direction_Info
 1989 0090 00000000 		.word	Position_Degree
 1990 0094 00007A44 		.word	1148846080
 1991 0098 00000000 		.word	Board_Mode
 1992 009c 00000000 		.word	.LC4
 1993 00a0 18000000 		.word	.LC5
 1994 00a4 00000000 		.word	.LANCHOR13
 1995 00a8 44000000 		.word	.LC6
 1996              		.cfi_endproc
 1997              	.LFE182:
 1999              		.section	.text.Theta_Handler,"ax",%progbits
 2000              		.align	1
 2001              		.global	Theta_Handler
 2002              		.syntax unified
 2003              		.thumb
 2004              		.thumb_func
 2005              		.fpu fpv4-sp-d16
 2007              	Theta_Handler:
 2008              	.LFB176:
 278:Src/foc.c     **** 
 2009              		.loc 1 278 1 is_stmt 1 view -0
 2010              		.cfi_startproc
 2011              		@ args = 0, pretend = 0, frame = 0
 2012              		@ frame_needed = 0, uses_anonymous_args = 0
 2013 0000 08B5     		push	{r3, lr}
 2014              	.LCFI36:
 2015              		.cfi_def_cfa_offset 8
 2016              		.cfi_offset 3, -8
 2017              		.cfi_offset 14, -4
 280:Src/foc.c     ****     switch (Board_Mode)
 2018              		.loc 1 280 5 view .LVU505
 280:Src/foc.c     ****     switch (Board_Mode)
 2019              		.loc 1 280 23 is_stmt 0 view .LVU506
 2020 0002 0120     		movs	r0, #1
 2021 0004 FFF7FEFF 		bl	Get_Position_Rad_Dgree
 2022              	.LVL136:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 54


 280:Src/foc.c     ****     switch (Board_Mode)
 2023              		.loc 1 280 21 view .LVU507
 2024 0008 184B     		ldr	r3, .L128
 2025 000a 83ED000A 		vstr.32	s0, [r3]
 281:Src/foc.c     ****     {
 2026              		.loc 1 281 5 is_stmt 1 view .LVU508
 2027 000e 184B     		ldr	r3, .L128+4
 2028 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2029 0012 052B     		cmp	r3, #5
 2030 0014 06D8     		bhi	.L118
 2031 0016 052B     		cmp	r3, #5
 2032 0018 0DD8     		bhi	.L117
 2033 001a DFE803F0 		tbb	[pc, r3]
 2034              	.L121:
 2035 001e 1A       		.byte	(.L124-.L121)/2
 2036 001f 0C       		.byte	(.L117-.L121)/2
 2037 0020 0A       		.byte	(.L123-.L121)/2
 2038 0021 0C       		.byte	(.L117-.L121)/2
 2039 0022 0D       		.byte	(.L122-.L121)/2
 2040 0023 21       		.byte	(.L120-.L121)/2
 2041              		.p2align 1
 2042              	.L118:
 2043 0024 F12B     		cmp	r3, #241
 2044 0026 11D0     		beq	.L125
 2045 0028 F32B     		cmp	r3, #243
 2046 002a 04D1     		bne	.L117
 2047              	.LBB4:
 304:Src/foc.c     ****         break;
 2048              		.loc 1 304 9 view .LVU509
 2049 002c FFF7FEFF 		bl	Muisc_Play_TIM_IRQ_Handler
 2050              	.LVL137:
 305:Src/foc.c     ****     default:
 2051              		.loc 1 305 9 view .LVU510
 2052              	.LBE4:
 309:Src/foc.c     **** 
 2053              		.loc 1 309 1 is_stmt 0 view .LVU511
 2054 0030 01E0     		b	.L117
 2055              	.L123:
 2056              	.LBB5:
 284:Src/foc.c     ****         break;
 2057              		.loc 1 284 9 is_stmt 1 view .LVU512
 2058 0032 FFF7FEFF 		bl	Foc
 2059              	.LVL138:
 285:Src/foc.c     ****     case VF_OPENLOOP:
 2060              		.loc 1 285 9 view .LVU513
 2061              	.L117:
 2062              	.LBE5:
 309:Src/foc.c     **** 
 2063              		.loc 1 309 1 is_stmt 0 view .LVU514
 2064 0036 08BD     		pop	{r3, pc}
 2065              	.L122:
 2066              	.LBB6:
 287:Src/foc.c     ****         break;
 2067              		.loc 1 287 9 is_stmt 1 view .LVU515
 2068 0038 B0EE081A 		vmov.f32	s2, #3.0e+0
 2069 003c 0120     		movs	r0, #1
 2070 003e DFED0D0A 		vldr.32	s1, .L128+8
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 55


 2071 0042 B7EE000A 		vmov.f32	s0, #1.0e+0
 2072 0046 FFF7FEFF 		bl	VF_Openloop_Control
 2073              	.LVL139:
 288:Src/foc.c     ****     case TEST_DIRECTION:
 2074              		.loc 1 288 9 view .LVU516
 2075 004a F4E7     		b	.L117
 2076              	.L125:
 290:Src/foc.c     ****         break;
 2077              		.loc 1 290 9 view .LVU517
 2078 004c FFF7FEFF 		bl	Test_Direction
 2079              	.LVL140:
 291:Src/foc.c     ****     case STOP_MODE:
 2080              		.loc 1 291 9 view .LVU518
 2081 0050 F1E7     		b	.L117
 2082              	.L124:
 293:Src/foc.c     ****         break;
 2083              		.loc 1 293 9 view .LVU519
 2084 0052 9FED090A 		vldr.32	s0, .L128+12
 2085 0056 F0EE400A 		vmov.f32	s1, s0
 2086 005a FFF7FEFF 		bl	SVPWM
 2087              	.LVL141:
 294:Src/foc.c     ****     case WAIT_MODE:
 2088              		.loc 1 294 9 view .LVU520
 2089 005e EAE7     		b	.L117
 2090              	.L120:
 299:Src/foc.c     ****         break;
 2091              		.loc 1 299 9 view .LVU521
 2092 0060 B7EE000A 		vmov.f32	s0, #1.0e+0
 2093 0064 FFF7FEFF 		bl	Measure_R_MS_Handler
 2094              	.LVL142:
 300:Src/foc.c     ****     case VOICE_MODE:
 2095              		.loc 1 300 9 view .LVU522
 2096 0068 E5E7     		b	.L117
 2097              	.L129:
 2098 006a 00BF     		.align	2
 2099              	.L128:
 2100 006c 00000000 		.word	Position_Degree
 2101 0070 00000000 		.word	Board_Mode
 2102 0074 00007A44 		.word	1148846080
 2103 0078 00000000 		.word	0
 2104              	.LBE6:
 2105              		.cfi_endproc
 2106              	.LFE176:
 2108              		.section	.text.HAL_TIM_PeriodElapsedCallback,"ax",%progbits
 2109              		.align	1
 2110              		.global	HAL_TIM_PeriodElapsedCallback
 2111              		.syntax unified
 2112              		.thumb
 2113              		.thumb_func
 2114              		.fpu fpv4-sp-d16
 2116              	HAL_TIM_PeriodElapsedCallback:
 2117              	.LVL143:
 2118              	.LFB174:
 223:Src/foc.c     **** 
 2119              		.loc 1 223 1 view -0
 2120              		.cfi_startproc
 2121              		@ args = 0, pretend = 0, frame = 0
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 56


 2122              		@ frame_needed = 0, uses_anonymous_args = 0
 223:Src/foc.c     **** 
 2123              		.loc 1 223 1 is_stmt 0 view .LVU524
 2124 0000 08B5     		push	{r3, lr}
 2125              	.LCFI37:
 2126              		.cfi_def_cfa_offset 8
 2127              		.cfi_offset 3, -8
 2128              		.cfi_offset 14, -4
 225:Src/foc.c     ****     {
 2129              		.loc 1 225 5 is_stmt 1 view .LVU525
 225:Src/foc.c     ****     {
 2130              		.loc 1 225 13 is_stmt 0 view .LVU526
 2131 0002 0268     		ldr	r2, [r0]
 225:Src/foc.c     ****     {
 2132              		.loc 1 225 8 view .LVU527
 2133 0004 054B     		ldr	r3, .L134
 2134 0006 9A42     		cmp	r2, r3
 2135 0008 00D0     		beq	.L133
 2136              	.LVL144:
 2137              	.L130:
 242:Src/foc.c     **** 
 2138              		.loc 1 242 1 view .LVU528
 2139 000a 08BD     		pop	{r3, pc}
 2140              	.LVL145:
 2141              	.L133:
 227:Src/foc.c     ****         {
 2142              		.loc 1 227 9 is_stmt 1 view .LVU529
 227:Src/foc.c     ****         {
 2143              		.loc 1 227 13 is_stmt 0 view .LVU530
 2144 000c 044B     		ldr	r3, .L134+4
 2145 000e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 227:Src/foc.c     ****         {
 2146              		.loc 1 227 12 view .LVU531
 2147 0010 002B     		cmp	r3, #0
 2148 0012 FAD0     		beq	.L130
 231:Src/foc.c     ****     }
 2149              		.loc 1 231 9 is_stmt 1 view .LVU532
 2150 0014 FFF7FEFF 		bl	Theta_Handler
 2151              	.LVL146:
 241:Src/foc.c     **** }
 2152              		.loc 1 241 5 view .LVU533
 2153 0018 F7E7     		b	.L130
 2154              	.L135:
 2155 001a 00BF     		.align	2
 2156              	.L134:
 2157 001c 00140040 		.word	1073746944
 2158 0020 00000000 		.word	Init_OK
 2159              		.cfi_endproc
 2160              	.LFE174:
 2162              		.section	.text.Set_Vector,"ax",%progbits
 2163              		.align	1
 2164              		.global	Set_Vector
 2165              		.syntax unified
 2166              		.thumb
 2167              		.thumb_func
 2168              		.fpu fpv4-sp-d16
 2170              	Set_Vector:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 57


 2171              	.LVL147:
 2172              	.LFB183:
 444:Src/foc.c     ****     CCR_Duty temp_duty = {0};
 2173              		.loc 1 444 1 view -0
 2174              		.cfi_startproc
 2175              		@ args = 0, pretend = 0, frame = 32
 2176              		@ frame_needed = 0, uses_anonymous_args = 0
 444:Src/foc.c     ****     CCR_Duty temp_duty = {0};
 2177              		.loc 1 444 1 is_stmt 0 view .LVU535
 2178 0000 10B5     		push	{r4, lr}
 2179              	.LCFI38:
 2180              		.cfi_def_cfa_offset 8
 2181              		.cfi_offset 4, -8
 2182              		.cfi_offset 14, -4
 2183 0002 88B0     		sub	sp, sp, #32
 2184              	.LCFI39:
 2185              		.cfi_def_cfa_offset 40
 2186 0004 6C46     		mov	r4, sp
 2187 0006 84E80F00 		stm	r4, {r0, r1, r2, r3}
 2188 000a F0EE407A 		vmov.f32	s15, s0
 445:Src/foc.c     ****     if(duty>0.95f){
 2189              		.loc 1 445 5 is_stmt 1 view .LVU536
 446:Src/foc.c     ****         duty=0.95f;
 2190              		.loc 1 446 5 view .LVU537
 446:Src/foc.c     ****         duty=0.95f;
 2191              		.loc 1 446 7 is_stmt 0 view .LVU538
 2192 000e 9FED127A 		vldr.32	s14, .L140
 2193 0012 B4EEC70A 		vcmpe.f32	s0, s14
 2194 0016 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 2195 001a 01DD     		ble	.L137
 447:Src/foc.c     ****     }
 2196              		.loc 1 447 13 view .LVU539
 2197 001c F0EE477A 		vmov.f32	s15, s14
 2198              	.L137:
 2199              	.LVL148:
 450:Src/foc.c     ****     temp_duty.ccrb = u.b * duty;
 2200              		.loc 1 450 5 is_stmt 1 view .LVU540
 450:Src/foc.c     ****     temp_duty.ccrb = u.b * duty;
 2201              		.loc 1 450 23 is_stmt 0 view .LVU541
 2202 0020 9DF80030 		ldrb	r3, [sp]	@ zero_extendqisi2
 2203 0024 00EE103A 		vmov	s0, r3	@ int
 450:Src/foc.c     ****     temp_duty.ccrb = u.b * duty;
 2204              		.loc 1 450 26 view .LVU542
 2205 0028 B8EEC00A 		vcvt.f32.s32	s0, s0
 451:Src/foc.c     ****     temp_duty.ccrc = u.c * duty;
 2206              		.loc 1 451 5 is_stmt 1 view .LVU543
 451:Src/foc.c     ****     temp_duty.ccrc = u.c * duty;
 2207              		.loc 1 451 23 is_stmt 0 view .LVU544
 2208 002c 9DF80130 		ldrb	r3, [sp, #1]	@ zero_extendqisi2
 2209 0030 00EE903A 		vmov	s1, r3	@ int
 451:Src/foc.c     ****     temp_duty.ccrc = u.c * duty;
 2210              		.loc 1 451 26 view .LVU545
 2211 0034 F8EEE00A 		vcvt.f32.s32	s1, s1
 452:Src/foc.c     **** 
 2212              		.loc 1 452 5 is_stmt 1 view .LVU546
 452:Src/foc.c     **** 
 2213              		.loc 1 452 23 is_stmt 0 view .LVU547
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 58


 2214 0038 9DF80230 		ldrb	r3, [sp, #2]	@ zero_extendqisi2
 2215 003c 01EE103A 		vmov	s2, r3	@ int
 452:Src/foc.c     **** 
 2216              		.loc 1 452 26 view .LVU548
 2217 0040 B8EEC11A 		vcvt.f32.s32	s2, s2
 454:Src/foc.c     **** }
 2218              		.loc 1 454 5 is_stmt 1 view .LVU549
 2219 0044 20EE270A 		vmul.f32	s0, s0, s15
 2220 0048 60EEA70A 		vmul.f32	s1, s1, s15
 2221 004c 21EE271A 		vmul.f32	s2, s2, s15
 2222 0050 FFF7FEFF 		bl	SVPWM_Step
 2223              	.LVL149:
 455:Src/foc.c     **** 
 2224              		.loc 1 455 1 is_stmt 0 view .LVU550
 2225 0054 08B0     		add	sp, sp, #32
 2226              	.LCFI40:
 2227              		.cfi_def_cfa_offset 8
 2228              		@ sp needed
 2229 0056 10BD     		pop	{r4, pc}
 2230              	.L141:
 2231              		.align	2
 2232              	.L140:
 2233 0058 3333733F 		.word	1064514355
 2234              		.cfi_endproc
 2235              	.LFE183:
 2237              		.comm	Measure_R_Info,24,4
 2238              		.global	Position_Offset
 2239              		.comm	Position_Degree,4,4
 2240              		.global	RPS
 2241              		.global	Uvects
 2242              		.global	U7
 2243              		.global	U5
 2244              		.global	U1
 2245              		.global	U3
 2246              		.global	U2
 2247              		.global	U6
 2248              		.global	U4
 2249              		.global	U0
 2250              		.global	Motor
 2251              		.comm	Test_Direction_Info,12,4
 2252              		.comm	Board_Mode,1,1
 2253              		.comm	Ibeta,4,4
 2254              		.comm	Ialpha,4,4
 2255              		.comm	ADC_Values_Raw2,8,4
 2256              		.comm	ADC_Values_Raw,8,4
 2257              		.section	.bss.CCR_Dutys.12957,"aw",%nobits
 2258              		.align	2
 2259              		.set	.LANCHOR11,. + 0
 2262              	CCR_Dutys.12957:
 2263 0000 00000000 		.space	12
 2263      00000000 
 2263      00000000 
 2264              		.section	.bss.U0,"aw",%nobits
 2265              		.align	2
 2266              		.set	.LANCHOR10,. + 0
 2269              	U0:
 2270 0000 00000000 		.space	16
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 59


 2270      00000000 
 2270      00000000 
 2270      00000000 
 2271              		.section	.bss.current1.12986,"aw",%nobits
 2272              		.align	2
 2273              		.set	.LANCHOR3,. + 0
 2276              	current1.12986:
 2277 0000 00000000 		.space	4
 2278              		.section	.bss.current2.12987,"aw",%nobits
 2279              		.align	2
 2280              		.set	.LANCHOR4,. + 0
 2283              	current2.12987:
 2284 0000 00000000 		.space	4
 2285              		.section	.bss.theta.12965,"aw",%nobits
 2286              		.align	2
 2287              		.set	.LANCHOR14,. + 0
 2290              	theta.12965:
 2291 0000 00000000 		.space	4
 2292              		.section	.data.Motor,"aw"
 2293              		.align	2
 2294              		.set	.LANCHOR13,. + 0
 2297              	Motor:
 2298 0000 07       		.byte	7
 2299 0001 000000   		.space	3
 2300 0004 00000000 		.word	0
 2301 0008 00000000 		.word	0
 2302 000c 00000000 		.space	4
 2303              		.section	.data.Position_Offset,"aw"
 2304              		.align	2
 2305              		.set	.LANCHOR12,. + 0
 2308              	Position_Offset:
 2309 0000 20CB5743 		.word	1129827104
 2310              		.section	.data.RPS,"aw"
 2311              		.align	2
 2314              	RPS:
 2315 0000 0000C040 		.word	1086324736
 2316              		.section	.data.U1,"aw"
 2317              		.align	2
 2318              		.set	.LANCHOR8,. + 0
 2321              	U1:
 2322 0000 00       		.byte	0
 2323 0001 00       		.byte	0
 2324 0002 01       		.byte	1
 2325 0003 00       		.space	1
 2326 0004 920A8640 		.word	1082526354
 2327 0008 00000000 		.space	8
 2327      00000000 
 2328              		.section	.data.U2,"aw"
 2329              		.align	2
 2330              		.set	.LANCHOR7,. + 0
 2333              	U2:
 2334 0000 00       		.byte	0
 2335 0001 01       		.byte	1
 2336 0002 00       		.byte	0
 2337 0003 00       		.space	1
 2338 0004 920A0640 		.word	1074137746
 2339 0008 00000000 		.space	8
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 60


 2339      00000000 
 2340              		.section	.data.U3,"aw"
 2341              		.align	2
 2342              		.set	.LANCHOR0,. + 0
 2345              	U3:
 2346 0000 00       		.byte	0
 2347 0001 01       		.byte	1
 2348 0002 01       		.byte	1
 2349 0003 00       		.space	1
 2350 0004 DB0F4940 		.word	1078530011
 2351 0008 00000000 		.space	8
 2351      00000000 
 2352              		.section	.data.U4,"aw"
 2353              		.align	2
 2354              		.set	.LANCHOR5,. + 0
 2357              	U4:
 2358 0000 01       		.byte	1
 2359 0001 00       		.byte	0
 2360 0002 00       		.byte	0
 2361 0003 00       		.space	1
 2362 0004 00000000 		.word	0
 2363 0008 00000000 		.space	8
 2363      00000000 
 2364              		.section	.data.U5,"aw"
 2365              		.align	2
 2366              		.set	.LANCHOR1,. + 0
 2369              	U5:
 2370 0000 01       		.byte	1
 2371 0001 00       		.byte	0
 2372 0002 01       		.byte	1
 2373 0003 00       		.space	1
 2374 0004 368DA740 		.word	1084722486
 2375 0008 00000000 		.space	8
 2375      00000000 
 2376              		.section	.data.U6,"aw"
 2377              		.align	2
 2378              		.set	.LANCHOR6,. + 0
 2381              	U6:
 2382 0000 01       		.byte	1
 2383 0001 01       		.byte	1
 2384 0002 00       		.byte	0
 2385 0003 00       		.space	1
 2386 0004 920A863F 		.word	1065749138
 2387 0008 00000000 		.space	8
 2387      00000000 
 2388              		.section	.data.U7,"aw"
 2389              		.align	2
 2390              		.set	.LANCHOR9,. + 0
 2393              	U7:
 2394 0000 01       		.byte	1
 2395 0001 01       		.byte	1
 2396 0002 01       		.byte	1
 2397 0003 00       		.space	1
 2398 0004 00000000 		.word	0
 2399 0008 00000000 		.space	8
 2399      00000000 
 2400              		.section	.data.Uvects,"aw"
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 61


 2401              		.align	2
 2402              		.set	.LANCHOR2,. + 0
 2405              	Uvects:
 2406 0000 00000000 		.word	U1
 2407 0004 00000000 		.word	U2
 2408 0008 00000000 		.word	U3
 2409 000c 00000000 		.word	U4
 2410 0010 00000000 		.word	U5
 2411 0014 00000000 		.word	U6
 2412              		.text
 2413              	.Letext0:
 2414              		.file 2 "c:\\arm_gcc\\arm-none-eabi\\include\\machine\\_default_types.h"
 2415              		.file 3 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\_stdint.h"
 2416              		.file 4 "Inc/foc.h"
 2417              		.file 5 "Drivers/CMSIS/Include/core_cm4.h"
 2418              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 2419              		.file 7 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f405xx.h"
 2420              		.file 8 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f4xx.h"
 2421              		.file 9 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 2422              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 2423              		.file 11 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_adc.h"
 2424              		.file 12 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 2425              		.file 13 "Inc/tim.h"
 2426              		.file 14 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\lock.h"
 2427              		.file 15 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\_types.h"
 2428              		.file 16 "c:\\arm_gcc\\lib\\gcc\\arm-none-eabi\\9.2.1\\include\\stddef.h"
 2429              		.file 17 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\reent.h"
 2430              		.file 18 "c:\\arm_gcc\\arm-none-eabi\\include\\math.h"
 2431              		.file 19 "Inc/adc.h"
 2432              		.file 20 "c:\\arm_gcc\\arm-none-eabi\\include\\stdlib.h"
 2433              		.file 21 "mylib/uart_ext.h"
 2434              		.file 22 "Drivers/CMSIS/Include/arm_math.h"
 2435              		.file 23 "mylib/as5047.h"
 2436              		.file 24 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 2437              		.file 25 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim_ex.h"
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 62


DEFINED SYMBOLS
                            *ABS*:00000000 foc.c
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:18     .text.SVPWM_Step:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:25     .text.SVPWM_Step:00000000 SVPWM_Step
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:78     .text.SVPWM_Step:00000058 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:83     .text.Measure_R_20Khz_Handler:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:89     .text.Measure_R_20Khz_Handler:00000000 Measure_R_20Khz_Handler
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:189    .text.Measure_R_20Khz_Handler:000000b0 $d
                            *COM*:00000001 Board_Mode
                            *COM*:00000018 Measure_R_Info
                            *COM*:00000008 ADC_Values_Raw2
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:202    .text.UVects_Init:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:208    .text.UVects_Init:00000000 UVects_Init
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:284    .text.UVects_Init:0000003c $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:290    .rodata.Measure_R_MS_Handler.str1.4:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:300    .text.Measure_R_MS_Handler:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:306    .text.Measure_R_MS_Handler:00000000 Measure_R_MS_Handler
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:545    .text.Measure_R_MS_Handler:00000158 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:562    .text.Foc_Init:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:569    .text.Foc_Init:00000000 Foc_Init
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:659    .text.Foc_Init:0000006c $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:669    .text.get_area:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:676    .text.get_area:00000000 get_area
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:699    .text.get_area:00000010 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:704    .text.get_area_u:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:711    .text.get_area_u:00000000 get_area_u
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:735    .text.get_area_u:00000010 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:741    .text.get_area_u:00000016 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:853    .text.get_area_u:00000084 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:863    .text.get_t:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:870    .text.get_t:00000000 get_t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:988    .text.get_t:00000098 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:993    .text.get_ccr_duty:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1000   .text.get_ccr_duty:00000000 get_ccr_duty
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1132   .text.get_ccr_duty:000000f0 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1137   .rodata.Set_to_U4.str1.4:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1141   .text.Set_to_U4:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1148   .text.Set_to_U4:00000000 Set_to_U4
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1227   .text.Set_to_U4:0000006c $d
                            *COM*:00000004 Position_Degree
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1235   .text.SVPWM_Normal_CalT1T2:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1242   .text.SVPWM_Normal_CalT1T2:00000000 SVPWM_Normal_CalT1T2
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1259   .text.SVPWM_Normal_CalT1T2:0000000a $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1265   .text.SVPWM_Normal_CalT1T2:00000010 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1389   .text.SVPWM_Normal_CalT1T2:000000c0 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1397   .text.SVPWM:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1403   .text.SVPWM:00000000 SVPWM
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1507   .text.SVPWM:00000094 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1513   .text.Park_Conv:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1520   .text.Park_Conv:00000000 Park_Conv
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1553   .text.Park_Conv:00000028 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1558   .text.HAL_ADC_ConvCpltCallback:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1565   .text.HAL_ADC_ConvCpltCallback:00000000 HAL_ADC_ConvCpltCallback
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1655   .text.HAL_ADC_ConvCpltCallback:00000074 $d
                            *COM*:00000004 Ibeta
                            *COM*:00000004 Ialpha
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1668   .text.Foc:00000000 $t
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 63


C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1675   .text.Foc:00000000 Foc
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1757   .text.Foc:00000064 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1766   .text.VF_Openloop_Control:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1773   .text.VF_Openloop_Control:00000000 VF_Openloop_Control
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1851   .text.VF_Openloop_Control:00000074 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1858   .rodata.Test_Direction.str1.4:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1868   .text.Test_Direction:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1874   .text.Test_Direction:00000000 Test_Direction
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:1988   .text.Test_Direction:0000008c $d
                            *COM*:0000000c Test_Direction_Info
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2000   .text.Theta_Handler:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2007   .text.Theta_Handler:00000000 Theta_Handler
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2035   .text.Theta_Handler:0000001e $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2041   .text.Theta_Handler:00000024 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2100   .text.Theta_Handler:0000006c $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2109   .text.HAL_TIM_PeriodElapsedCallback:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2116   .text.HAL_TIM_PeriodElapsedCallback:00000000 HAL_TIM_PeriodElapsedCallback
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2157   .text.HAL_TIM_PeriodElapsedCallback:0000001c $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2163   .text.Set_Vector:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2170   .text.Set_Vector:00000000 Set_Vector
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2233   .text.Set_Vector:00000058 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2308   .data.Position_Offset:00000000 Position_Offset
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2314   .data.RPS:00000000 RPS
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2405   .data.Uvects:00000000 Uvects
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2393   .data.U7:00000000 U7
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2369   .data.U5:00000000 U5
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2321   .data.U1:00000000 U1
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2345   .data.U3:00000000 U3
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2333   .data.U2:00000000 U2
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2381   .data.U6:00000000 U6
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2357   .data.U4:00000000 U4
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2269   .bss.U0:00000000 U0
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2297   .data.Motor:00000000 Motor
                            *COM*:00000008 ADC_Values_Raw
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2258   .bss.CCR_Dutys.12957:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2262   .bss.CCR_Dutys.12957:00000000 CCR_Dutys.12957
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2265   .bss.U0:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2272   .bss.current1.12986:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2276   .bss.current1.12986:00000000 current1.12986
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2279   .bss.current2.12987:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2283   .bss.current2.12987:00000000 current2.12987
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2286   .bss.theta.12965:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2290   .bss.theta.12965:00000000 theta.12965
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2293   .data.Motor:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2304   .data.Position_Offset:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2311   .data.RPS:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2317   .data.U1:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2329   .data.U2:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2341   .data.U3:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2353   .data.U4:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2365   .data.U5:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2377   .data.U6:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2389   .data.U7:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s:2401   .data.Uvects:00000000 $d

UNDEFINED SYMBOLS
cosf
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccvuBBhT.s 			page 64


sinf
__aeabi_f2d
uprintf_polling
HAL_TIM_PWM_Start
HAL_TIMEx_PWMN_Start
HAL_TIM_Base_Start_IT
HAL_TIM_Base_Start
htim8
htim7
htim6
arm_sin_cos_f32
HAL_Delay
uprintf
Get_Position_Rad_Dgree
Muisc_Play_TIM_IRQ_Handler
Init_OK
